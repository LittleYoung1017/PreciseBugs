--- /Base64.java	2023-07-04 03:53:01.708750261 +0000
+++ /Codec-1/src/java/org/apache/commons/codec/binary/Base64.java	2023-07-04 03:53:01.712750207 +0000
@@ -276,7 +276,7 @@
             encodedDataLengthLong = (tripletCount + 1) * 4;
         } else {
             // 16 or 8 bit
-            encodedDataLengthLong = tripletCount * 4;
+encodedDataLengthLong = lengthDataBits * 4;
         }
 
         // If the output is to be "chunked" into 76 character sections,
