a3786b86c	3e360f42f	Sat Feb 25 05:57:43 2023 -0600	slist: fix possible NULL derefence	commit a3786b86cfd630039d0119ee9fc9ef5870df9be6Author: David Korczynski <david@adalogics.com>Date:   Thu Feb 23 08:10:18 2023 -0800    slist: fix possible NULL derefence        flb_sds_create_len can fail and return NULL. This adds a safeguard to    ensure no NULL dereference happens if that's the case.        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=56223        Signed-off-by: David Korczynski <david@adalogics.com>
fa7fd13c1	0a0491d0e	Tue Dec 6 16:46:40 2022 -0600	tests: internal: fuzzers: fix offset	commit fa7fd13c1ffbae70dd089945a90d4045bc80f1d8Author: David Korczynski <david@adalogics.com>Date:   Mon Nov 28 02:21:45 2022 -0800    tests: internal: fuzzers: fix offset        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=53103        Signed-off-by: David Korczynski <david@adalogics.com>
5949473d5	1837c5a02	Fri Dec 2 22:24:27 2022 -0600	parser: fix overflow	commit 5949473d5ce9e3d56ae2e248cc3a82a13474aabdAuthor: David Korczynski <david@adalogics.com>Date:   Mon Nov 28 02:55:11 2022 -0800    parser: fix overflow        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=52414        Signed-off-by: David Korczynski <david@adalogics.com>
a7eca37d3	b40a404f8	Tue Oct 11 11:04:02 2022 -0600	strptime: fix integer boundary	commit a7eca37d3aaa617a0cd34cb0dd0f7f3f25b0594cAuthor: David Korczynski <david@adalogics.com>Date:   Fri Oct 7 14:59:09 2022 +0100    strptime: fix integer boundary        The current boundary is wrong, this fixes it.        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=51024        Signed-off-by: David Korczynski <david@adalogics.com>
e2c524ba7	60c668c82	Sat Sep 10 06:53:08 2022 +0900	parser: fix double-free	commit e2c524ba7bf0487ba3df569cce8855cb753f084aAuthor: David Korczynski <david@adalogics.com>Date:   Fri Sep 9 14:40:14 2022 +0100    parser: fix double-free        It's not necessary to free tmp here as tmp is freed at fconf_error        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=51132        Signed-off-by: David Korczynski <david@adalogics.com>
60c668c82	2ed2f3334	Fri Sep 9 14:00:19 2022 -0600	pack: fix read stack-buffer-overflow READ in msgpack_sbuffer_write (#5731)	commit 60c668c824a46a88e332c73737423043e2ded3faAuthor: Alex <93376818+sashashura@users.noreply.github.com>Date:   Fri Sep 9 22:00:19 2022 +0200    pack: fix read stack-buffer-overflow READ in msgpack_sbuffer_write (#5731)        * pack: Fix read Stack-buffer-overflow READ in msgpack_sbuffer_write        This PR fixes Stack-buffer-overflow in msgpack_sbuffer_write revealed by fuzzing:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45208        The root cause is that snprintf call in flb_pack_msgpack_to_json_format returns the number of characters that would have been written if the buffer had been sufficiently large.    It leads to reading out of the boundaries of the buffer later.        Signed-off-by: sashashura <aleksandrosansan@gmail.com>
49e3a0bc1	29a8b88ae	Fri Sep 2 20:56:53 2022 -0600	strptime: fix signed overflow	commit 49e3a0bc16f33b91f5921887e211c59f867a7e74Author: David Korczynski <david@adalogics.com>Date:   Fri Sep 2 17:07:05 2022 +0100    strptime: fix signed overflow        Return 0 if signed integer overflows occur        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=47092        Signed-off-by: David Korczynski <david@adalogics.com>
98abed26d	d07c7c6db	Fri Sep 2 20:52:06 2022 -0600	tests: internal: fuzzers: fix index error	commit 98abed26d3ed76079a66a7c2735a19b0ac347b8eAuthor: David Korczynski <david@adalogics.com>Date:   Fri Sep 2 12:02:23 2022 +0100    tests: internal: fuzzers: fix index error        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45911        Signed-off-by: David Korczynski <david@adalogics.com>
b71a561cd	0c5d8da6b	Thu Sep 1 17:18:28 2022 -0600	pack: fix oss-fuzz crashon tokens state (#5975)	commit b71a561cd2bf3cdc40335c0f4c701a5be070c8d3Author: Alex <93376818+sashashura@users.noreply.github.com>Date:   Fri Sep 2 01:18:28 2022 +0200    pack: fix oss-fuzz crashon tokens state (#5975)        https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45978        Signed-off-by: sashashura <93376818+sashashura@users.noreply.github.com>
74a21b176	676a26b24	Fri Aug 19 18:23:05 2022 -0600	pack: fix heap-double-free in flb_pack_state_reset (#5883)	commit 74a21b176cd941c39b10086ee9e0343a904f3178Author: Aleks L <93376818+sashashura@users.noreply.github.com>Date:   Sat Aug 20 01:23:05 2022 +0100    pack: fix heap-double-free in flb_pack_state_reset (#5883)        https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45978        Signed-off-by: Aleks L <93376818+sashashura@users.noreply.github.com>
639806ce3	51956949b	Wed Jul 6 11:57:50 2022 -0600	tests: internal: fuzzers: fix index error	commit 639806ce3eea2bf8fd4ce0e105989998adb8c207Author: David Korczynski <david@adalogics.com>Date:   Tue Jun 21 15:02:40 2022 +0100    tests: internal: fuzzers: fix index error        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45911        Signed-off-by: David Korczynski <david@adalogics.com>
51956949b	c42079e63	Wed Jul 6 11:57:25 2022 -0600	record_accessor: fix possible null-deref (#5101)	commit 51956949b38e3388775450b621685414b4809afbAuthor: DavidKorczynski <david@adalogics.com>Date:   Wed Jul 6 18:57:25 2022 +0100    record_accessor: fix possible null-deref (#5101)        Check rp->key is set before dereferencing. This fixes:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45642        Signed-off-by: David Korczynski <david@adalogics.com>
68ef2425f	a654f84d5	Mon Apr 25 21:59:37 2022 -0600	output: fix potential NULL deref	commit 68ef2425fbfae416e8c7ac817b8bf9f19aa2da5cAuthor: David Korczynski <david@adalogics.com>Date:   Thu Mar 17 12:16:20 2022 +0000    output: fix potential NULL deref        Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45644        Signed-off-by: David Korczynski <david@adalogics.com>
26539ec7a	b4a227710	Mon Apr 25 21:58:10 2022 -0600	parser: fix null dereference	commit 26539ec7ab239fa86877897b0ceede329e98cc88Author: David Korczynski <david@adalogics.com>Date:   Thu Mar 17 14:42:27 2022 +0000    parser: fix null dereference        Avooid calling strcmp with potential NULL. This fixes    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45648        Signed-off-by: David Korczynski <david@adalogics.com>
228368152	3b50e7234	Mon Feb 21 20:56:56 2022 -0600	tests: internal: multiline: fix leak (#4885)	commit 2283681529fc1eadd7f7127e7bce9086b6f015ceAuthor: DavidKorczynski <david@adalogics.com>Date:   Tue Feb 22 02:56:56 2022 +0000    tests: internal: multiline: fix leak (#4885)        Ensure result is destroyed before returning. Fixes:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=38362        Signed-off-by: David Korczynski <david@adalogics.com>
ce08fb9ea	f8d806f20	Sun Feb 20 13:16:09 2022 -0600	config: fix memory leak	commit ce08fb9ea58c331cf2096e8048da57afd3ee1f8aAuthor: David Korczynski <david@adalogics.com>Date:   Fri Feb 18 23:56:42 2022 +0000    config: fix memory leak        Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=42097        Signed-off-by: David Korczynski <david@adalogics.com>
05144b2d9	26c796fc6	Mon Sep 6 18:01:22 2021 -0600	tests: internal: fuzzers: fix issue in utils fuzzer	commit 05144b2d99a4d88db561d0329e4bd97453d466e1Author: David Korczynski <david@adalogics.com>Date:   Fri Sep 3 12:53:01 2021 +0100    tests: internal: fuzzers: fix issue in utils fuzzer        Fixes bug: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=36718        Signed-off-by: David Korczynski <david@adalogics.com>
8d732092a	27a11aef6	Tue Jul 20 09:45:45 2021 -0600	signv4: fix NULL dereference	commit 8d732092a3e6179e5133d1ca2bf08007c7a5e493Author: David Korczynski <david@adalogics.com>Date:   Tue Jul 20 12:25:37 2021 +0100    signv4: fix NULL dereference        Fixes bug: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=31801        Signed-off-by: David Korczynski <david@adalogics.com>
05403879e	5888f7867	Thu Jan 21 16:32:52 2021 -0600	utils: fix data type to avoid overflow (oss-fuzz 26595)	commit 05403879ee0419e1b2318d03033397a2b15ee965Author: Eduardo Silva <eduardo@treasure-data.com>Date:   Thu Jan 21 16:32:52 2021 -0600    utils: fix data type to avoid overflow (oss-fuzz 26595)        Signed-off-by: Eduardo Silva <eduardo@treasure-data.com>
6117a16d9	873890662	Wed Dec 2 14:34:27 2020 -0600	http client: fix oss-fuzz definition	commit 6117a16d9e978f15b09933a1dd69450670d71c7fAuthor: davkor <david@adalogics.com>Date:   Mon Nov 30 10:30:33 2020 +0000    http client: fix oss-fuzz definition        Signed-off-by: davkor <david@adalogics.com>
69def19f2	8777d5bb5	Wed Nov 25 22:53:49 2020 -0600	json parser: Fix null-dereference (oss-fuzz 27764)	commit 69def19f264e4ca25c98adedfd141094d40903e2Author: davkor <david@adalogics.com>Date:   Mon Nov 23 15:28:15 2020 +0000    json parser: Fix null-dereference (oss-fuzz 27764)        Signed-off-by: davkor <david@adalogics.com>
8315c5029	b366ede81	Wed Nov 25 22:53:49 2020 -0600	pack gelf: fix stack buffer overflow on temp variable (oss-fuzz 26237)	commit 8315c5029f1b8bc855a2263b1986f22d24cd1a3bAuthor: davkor <david@adalogics.com>Date:   Mon Nov 23 14:56:01 2020 +0000    pack gelf: fix stack buffer overflow on temp variable (oss-fuzz 26237)        Signed-off-by: davkor <david@adalogics.com>
b366ede81	ac83f8e1b	Wed Nov 25 22:53:49 2020 -0600	record accessor: fix multiple NULL dereferences (oss-fuzz 27234 and oss-fuzz testcase 4907517888692224)	commit b366ede812b70ae43afb28d6430c26d371900c2eAuthor: davkor <david@adalogics.com>Date:   Mon Nov 23 14:15:41 2020 +0000    record accessor: fix multiple NULL dereferences (oss-fuzz 27234 and    oss-fuzz testcase 4907517888692224)        Signed-off-by: davkor <david@adalogics.com>
ac83f8e1b	d118cebb9	Wed Nov 25 22:53:49 2020 -0600	signv4: fix write heap-overflow	commit ac83f8e1b208d5427ca5b99cf40549771987bc85Author: davkor <david@adalogics.com>Date:   Mon Nov 23 12:16:03 2020 +0000    signv4: fix write heap-overflow        This is not on oss-fuzz yet, but the bug occurs when len is zero, and    a write is performed on out[len-1]. In this case we write to the left of    the allocated buffer.        Signed-off-by: davkor <david@adalogics.com>
d118cebb9	0a23aab58	Wed Nov 25 22:53:49 2020 -0600	signv4: fix write heap-overflow (oss-fuzz 27710)	commit d118cebb93846c690b86187af890c11ff602d18cAuthor: davkor <david@adalogics.com>Date:   Mon Nov 23 12:14:34 2020 +0000    signv4: fix write heap-overflow (oss-fuzz 27710)        Signed-off-by: davkor <david@adalogics.com>
611642182	d67f28b5b	Fri Nov 13 14:14:44 2020 -0600	parser: fix inconsistent memory allocation in parser creation (#2760)	commit 61164218298f9dbee5bac6648b5b4f5e97759bbaAuthor: DavidKorczynski <david@adalogics.com>Date:   Fri Nov 13 20:14:44 2020 +0000    parser: fix inconsistent memory allocation in parser creation (#2760)        * parser: fix inconsistent memory allocation in parser creation (oss-fuzz    26345)        This commit fixes https://github.com/fluent/fluent-bit/issues/2686 by    avoiding any free of memory provided by the caller in flb_parser_create.        Signed-off-by: davkor <david@adalogics.com>
7c265e23b	abe7301b1	Sat Nov 7 10:40:19 2020 -0600	config_map: fix cases where kv->val is NULL (oss-fuzz issue 27023)	commit 7c265e23bd2c7592ac9987ea92daa426ce48263aAuthor: davkor <david@adalogics.com>Date:   Sat Nov 7 15:36:15 2020 +0000    config_map: fix cases where kv->val is NULL (oss-fuzz issue 27023)        Signed-off-by: davkor <david@adalogics.com>
abe7301b1	163af0b9c	Sat Nov 7 10:40:19 2020 -0600	parser: fix to ensure string size is enough for comparison (oss-fuzz testcase 5200866812100608)	commit abe7301b134b0114241ce8b0b6ebbd5d18346fc2Author: davkor <david@adalogics.com>Date:   Sat Nov 7 14:48:38 2020 +0000    parser: fix to ensure string size is enough for comparison (oss-fuzz testcase 5200866812100608)        Signed-off-by: davkor <david@adalogics.com>
163af0b9c	cadff53c0	Sat Nov 7 10:40:19 2020 -0600	strptime: fix bounds check (oss-fuzz 27241)	commit 163af0b9c0513f31cc4cbfe8aeee26d22513163cAuthor: davkor <david@adalogics.com>Date:   Sat Nov 7 14:05:30 2020 +0000    strptime: fix bounds check (oss-fuzz 27241)        Signed-off-by: davkor <david@adalogics.com>
cadff53c0	d75062d7c	Sat Nov 7 10:40:19 2020 -0600	gzip: fix compression size calculation (oss-fuzz 27261)	commit cadff53c093210404aed01c4cf586adb8caa07afAuthor: davkor <david@adalogics.com>Date:   Sat Nov 7 13:59:02 2020 +0000    gzip: fix compression size calculation (oss-fuzz 27261)        Signed-off-by: davkor <david@adalogics.com>
7f0c3bb1b	7a588237f	Thu Nov 5 14:05:26 2020 -0600	parser: fix insecure string pass (oss-fuzz 26325)	commit 7f0c3bb1bd8645ca556125b5afae8db77f973085Author: davkor <david@adalogics.com>Date:   Sat Oct 31 16:48:00 2020 +0000    parser: fix insecure string pass (oss-fuzz 26325)        Signed-off-by: davkor <david@adalogics.com>
7a588237f	c2e33ae40	Thu Nov 5 14:05:26 2020 -0600	hash: fix null-derefence by ensure id is within size (oss-fuzz test case 5672848712269824)	commit 7a588237fdb744e5825fb119753dcad2e8878866Author: davkor <david@adalogics.com>Date:   Sat Oct 31 15:22:25 2020 +0000    hash: fix null-derefence by ensure id is within size (oss-fuzz test case 5672848712269824)        Signed-off-by: davkor <david@adalogics.com>
c2e33ae40	979a9bb72	Thu Nov 5 14:05:26 2020 -0600	utils: fix case of empty string in time to sec conversion (oss-fuzz 26593)	commit c2e33ae40af02fabe59b51637501a5be73583a15Author: davkor <david@adalogics.com>Date:   Sat Oct 31 14:23:00 2020 +0000    utils: fix case of empty string in time to sec conversion (oss-fuzz 26593)        Signed-off-by: davkor <david@adalogics.com>
979a9bb72	e5289e606	Thu Nov 5 14:05:26 2020 -0600	utils: fix bad handling of utf-8 parsing (oss-fuzz 26304)	commit 979a9bb728b490659e7e6076c17f3e4cb2c5bd59Author: davkor <david@adalogics.com>Date:   Sat Oct 31 14:00:01 2020 +0000    utils: fix bad handling of utf-8 parsing (oss-fuzz 26304)        Signed-off-by: davkor <david@adalogics.com>
15254d5bb	62858e40e	Mon Sep 21 15:19:20 2020 -0600	utils: fix bad handling of invalid utf-8 bytes (oss-fuzz 25785)	commit 15254d5bb2101995b32c7e34e86d01a1a878590bAuthor: Eduardo Silva <eduardo@treasure-data.com>Date:   Mon Sep 21 15:19:20 2020 -0600    utils: fix bad handling of invalid utf-8 bytes (oss-fuzz 25785)        Signed-off-by: Eduardo Silva <eduardo@treasure-data.com>
c81069636	29442b9ed	Sat May 9 21:43:14 2020 -0600	unescape: fix overflow on unescaping string (oss-fuzz 22132)	commit c81069636b90c4f24ed54a30bb8a15fba17a1094Author: Eduardo Silva <eduardo@treasure-data.com>Date:   Sat May 9 21:43:14 2020 -0600    unescape: fix overflow on unescaping string (oss-fuzz 22132)        Signed-off-by: Eduardo Silva <eduardo@treasure-data.com>
418cf0339	d6f7e237f	Fri May 8 13:59:33 2020 -0600	parser: logfmt: fix overflow (oss-fuzz 21953)	commit 418cf03390093f4f50507c4388ef9e4d897724d4Author: Eduardo Silva <eduardo@treasure-data.com>Date:   Fri May 8 13:59:33 2020 -0600    parser: logfmt: fix overflow (oss-fuzz 21953)        Signed-off-by: Eduardo Silva <eduardo@treasure-data.com>
38f2be4d0	81deab2bb	Wed Apr 29 10:58:38 2020 -0600	parser: ltsv: fix potential overflow (oss-fuzz)	commit 38f2be4d0a8a7be68b7ba31cd3dec884ae78776dAuthor: David Korczynski <david@adalogics.com>Date:   Wed Apr 29 10:58:38 2020 -0600    parser: ltsv: fix potential overflow (oss-fuzz)        Signed-off-by: Eduardo Silva <eduardo@treasure-data.com>
81deab2bb	e055944e3	Tue Apr 28 18:27:20 2020 -0600	parser: ltsv: fix overflow (oss-fuzz)	commit 81deab2bb042c814cee964563c12e8bdd55d8af3Author: Eduardo Silva <eduardo@treasure-data.com>Date:   Tue Apr 28 18:27:20 2020 -0600    parser: ltsv: fix overflow (oss-fuzz)        Signed-off-by: Eduardo Silva <eduardo@treasure-data.com>
e055944e3	4a88d4217	Tue Apr 28 18:25:25 2020 -0600	parser: logfmt: fix overflow (oss-fuzz)	commit e055944e3ccd60996a3aa333fa14be12cbc6972fAuthor: Eduardo Silva <eduardo@treasure-data.com>Date:   Tue Apr 28 18:25:25 2020 -0600    parser: logfmt: fix overflow (oss-fuzz)        Signed-off-by: Eduardo Silva <eduardo@treasure-data.com>
