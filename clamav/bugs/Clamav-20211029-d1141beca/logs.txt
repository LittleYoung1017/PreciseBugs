commit d1141becac82099de46f94f5d7a02d60cb1baf1d
Author: Micah Snyder <micasnyd@cisco.com>
Date:   Thu Oct 28 16:58:21 2021 -0700

    Fix fmap handle_gets() page arithmetic
    
    The fixes to the fmap bounds for nested (duplicate) fmaps added recently
    introduced a subtle arithmetic bug that was detected by OSS-Fuzz:
    
    ```c
    scanat = m->nested_offset + *at % m->pgsz;
    ```
    should have been:
    ```c
    scanat = (m->nested_offset + *at) % m->pgsz;
    ```
    Without the parenthesis, `scanat` could be > `m->pgsz`, which would
    overflow in the subsequent `memchr()` call.
    
    See:
    - https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40452
    - https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40455
    
    This commit also tightens up some of the other bounds checks done with
    `CLI_ISCONTAINED()` macro so the check limits the bounds to the nested
    fmap and not the original map.
    
    In addition, I've added a `CLI_ISCONTAINED_0_TO()` macro that removes
    checks when the "bigger" buffer starts at offset 0. This should silence
    a bunch of (benign) warnings and medium severity Coverity issues.
    
    There is also a possible use of an uninitialized variable
    (`old_hook_lsig_matches`) in `cli_magic_scan()`.
    
    Finally, I also removed an unecessary NULL-check on `filebase` in
    `fmap_dup_to_file()` that Coverity was unhappy with.
