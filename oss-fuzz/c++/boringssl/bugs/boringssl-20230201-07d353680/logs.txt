commit 07d353680fa7d96e77ba93382deddd030793def4Author: David Benjamin <davidben@google com>Date:  Tue Jan 31 15:18:56 2023 -0500  Fix leak on invalid input to a2i_GENERAL_NAME     Also add some tests for this syntax The error-handling here is slightly  subtle Although we do call GENERAL_NAME_free on the temporary  GENERAL_NAME on error, GENERAL_NAME's value is freed based on the  type field That means if you add an object to the value but don't set  the type, it won't be freed     Only the OTHERNAME codepath was affected by this, and a malloc  failure-only case in the is_string path I've gone ahead and reworked  all the paths so setting the type happens at the same time as setting  the value, so this invariant is more locally obvious     This only impacts the unsafe, stringly-typed extensions-building APIs  that no one should be using anyway     Bug: oss-fuzz:55569  Change-Id: I6390e4ac1142264cdc86f95fd850f1b8f81e3fc9  Reviewed-on: https://boringssl-review googlesource com/c/boringssl/+/56725  Reviewed-by: Adam Langley <agl@google com>  Commit-Queue: David Benjamin <davidben@google com>  Auto-Submit: David Benjamin <davidben@google com>
