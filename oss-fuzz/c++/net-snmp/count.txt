6cac0c8425	763e9cd5c0	Sun Oct 16 15:51:37 2022 -0700	libsnmp: Fix a recently introduced buffer overflow	commit 6cac0c842537b9b6aaa104d909a06b85192793a6Author: Bart Van Assche <bvanassche@acm.org>Date:   Sun Oct 16 15:24:18 2022 -0700    libsnmp: Fix a recently introduced buffer overflow        The buffer overflow can be triggered by making the ASN encoding of the first    two components of an OID occupy more bytes than the ASN encoding of the first    two components truncated to 32 bits.        Fixes: a0a02e5e5e8c ("libsnmp: Make the asn_build_objid() implementation shorter")    Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=52465
d0cb4afee0	1e9835fab1	Mon Sep 5 20:09:04 2022 -0700	testing/fuzzing/snmp_e2e_fuzzer: Fix a recently introduced memory leak	commit d0cb4afee07c5edb41ae9758c6b9be192e581b8aAuthor: Bart Van Assche <bvanassche@acm.org>Date:   Mon Sep 5 20:09:04 2022 -0700    testing/fuzzing/snmp_e2e_fuzzer: Fix a recently introduced memory leak        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=50819
48c0f03e2b	30faaeb4e2	Sun Aug 14 06:59:09 2022 -0700	testing/fuzzing/snmp_api_fuzzer.c: Fix a double free	commit 48c0f03e2bc0acec5e6259dcc11b1d887fc9173dAuthor: Bart Van Assche <bvanassche@acm.org>Date:   Thu Aug 11 07:18:54 2022 -0700    testing/fuzzing/snmp_api_fuzzer.c: Fix a double free        Strings returned by af_gb_get_null_terminated() are garbage-collected.    A PDU owns the security name. Fix a double free by changing an    af_gb_get_null_terminated() call into a af_get_null_terminated() call.        Fixes: 8babb2d078f8 ("testing/fuzzing: Improve snmp_api_fuzzer")    Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=50042
492db2155b	e65fa765b8	Sun Aug 14 06:56:30 2022 -0700	libsnmp: Fix a potential integer overflow in snmp_add_var()	commit 492db2155b64ba3f4f1428a7d58cc509be814357Author: Bart Van Assche <bvanassche@acm.org>Date:   Thu Aug 11 20:05:13 2022 -0700    libsnmp: Fix a potential integer overflow in snmp_add_var()        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40215
e65fa765b8	b75148e62e	Sun Aug 14 06:56:30 2022 -0700	libsnmp: Fix a recently introduced potential integer overflow	commit e65fa765b8ddc483cf496ecaece9e328e24cf8b6Author: Bart Van Assche <bvanassche@acm.org>Date:   Thu Aug 11 19:53:30 2022 -0700    libsnmp: Fix a recently introduced potential integer overflow        Fixes: d65925a9f8f6 ("libsnmp: Ignore invalid DISPLAY-HINT clauses")    Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=50063
041396bce7	9150354938	Wed Aug 10 21:51:32 2022 -0700	testing/fuzzing/snmp_api_fuzzer.c: Fix a memory leak	commit 041396bce75d3780a0b5a808eb33310f49b00601Author: Bart Van Assche <bvanassche@acm.org>Date:   Wed Aug 10 21:51:32 2022 -0700    testing/fuzzing/snmp_api_fuzzer.c: Fix a memory leak        This patch should fix    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40420.
6c434359f5	4d43fbd64a	Mon Jul 25 12:27:08 2022 -0700	testing/fuzzing: fix transport fuzzer coverage	commit 6c434359f549113d0d22f67a401ba5ba9aac7471Author: David Korczynski <david@adalogics.com>Date:   Mon Jul 25 15:30:20 2022 +0100    testing/fuzzing: fix transport fuzzer coverage        This patch fixes an unexpected-exit issue    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40640 which    is likely the cause of a coverage failure issue    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=46588        The problem is netsnmp_tdomain_transport_full eventually forks the    process and also calls exit, which is not compatible with fuzzing. As    such, the function should not be called by the fuzzer.        Signed-off-by: David Korczynski <david@adalogics.com>
0ccf55e7e9	8c3a094fbe	Tue Dec 28 14:11:11 2021 -0800	libsnmp: Fix a memory leak in an error path of parse_objectid()	commit 0ccf55e7e9c19c8e23bd94b19901ed8692423293Author: Bart Van Assche <bvanassche@acm.org>Date:   Tue Dec 28 14:03:18 2021 -0800    libsnmp: Fix a memory leak in an error path of parse_objectid()        Link newly allocated nodes earlier such that these are freed from the    error path.        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=39320    Fixes: 5201c852e0f6 ("Initial revision")
1a560274d0	d26d9e4570	Tue Nov 9 21:13:55 2021 -0800	libsnmp: Fix stack-based buffer underflow	commit 1a560274d0f440d5c604c36b2c32b36e2a3d9a28Author: David Korczynski <david@adalogics.com>Date:   Sat Nov 6 00:18:56 2021 +0000    libsnmp: Fix stack-based buffer underflow        Ensure `strlen(defbuf)` is above zero before the code    `defbuf[strlen(defbuf) - 1] = 0;`    Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40699        Signed-off-by: David Korczynski <david@adalogics.com>
9b60768643	abd1c59442	Sat Nov 6 00:18:56 2021 +0000	libsnmp: Fix stack-based buffer underflow	commit 9b607686437e661095a0113f2441ff0e6feeaad1Author: David Korczynski <david@adalogics.com>Date:   Sat Nov 6 00:18:56 2021 +0000    libsnmp: Fix stack-based buffer underflow        Ensure `strlen(defbuf)` is above zero before the code    `defbuf[strlen(defbuf) - 1] = 0;`    Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40699        Signed-off-by: David Korczynski <david@adalogics.com>
23a1282578	9cbbbb5f8a	Mon Nov 1 21:36:49 2021 +0000	libsnmp: Fix stack-based buffer overflow	commit 23a12825781d463c0509b034035c60ef9c90af11Author: David Korczynski <david@adalogics.com>Date:   Mon Nov 1 21:36:49 2021 +0000    libsnmp: Fix stack-based buffer overflow        Ensure len is above 0 before the code 'utc[len - 1]'.    Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40508        Signed-off-by: David Korczynski <david@adalogics.com>
ce0e69e61c	875e5d8b49	Wed Oct 20 13:29:13 2021 +0100	libsnmp: Fix NULL-dereference	commit ce0e69e61cda59f17773c32678d6a808aae44edeAuthor: David Korczynski <david@adalogics.com>Date:   Wed Oct 20 13:29:13 2021 +0100    libsnmp: Fix NULL-dereference        Ensure no derefence occurs if both otp and xxroot are NULL.    Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=39072        Signed-off-by: David Korczynski <david@adalogics.com>
abc8f77c6a	875e5d8b49	Wed Oct 20 13:07:14 2021 +0100	libsnmp: Fix stack-based buffer overflow	commit abc8f77c6a1e57c6ba12c77d47026e8602ff93f5Author: David Korczynski <david@adalogics.com>Date:   Wed Oct 20 13:07:14 2021 +0100    libsnmp: Fix stack-based buffer overflow        Ensure the code `get_token(fp, nexttoken, nexttype);` does not have    nexttype larger than MAXTOKEN as otherwise nexttoken can overflow.        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=37187        Signed-off-by: David Korczynski <david@adalogics.com>
fc00933891	875e5d8b49	Wed Oct 20 11:44:46 2021 +0100	libnsmp: Fix off-by-one read	commit fc009338911043dcf288c333082a005f6f916f2dAuthor: David Korczynski <david@adalogics.com>Date:   Wed Oct 20 11:44:46 2021 +0100    libnsmp: Fix off-by-one read        Prevent that the code 'line[linelen - 1]' reads a negative index.    This fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=36908        Signed-off-by: David Korczynski <david@adalogics.com>
6e32ddd87c	7e27589f3b	Tue Oct 19 16:39:23 2021 +0100	snmpd: Fix potential NULL-dereference	commit 6e32ddd87cd0da79e57f5fb88fd2e011f6ca1f78Author: David Korczynski <david@adalogics.com>Date:   Tue Oct 19 16:39:23 2021 +0100    snmpd: Fix potential NULL-dereference        Ensure the code 'asp->requests->agent_req_info' will not dereference a    NULL pointer.        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40086        Signed-off-by: David Korczynski <david@adalogics.com>
455d58c3ce	7e27589f3b	Tue Oct 19 16:34:54 2021 +0100	libsnmp: Fix spurious buffer read	commit 455d58c3ce8dfe57d10181b638605af69b550e76Author: David Korczynski <david@adalogics.com>Date:   Tue Oct 19 16:34:54 2021 +0100    libsnmp: Fix spurious buffer read        Ensure 'ix' is in range of 'buf' so the code 'buf[ix] |= bit;' is valid.    This fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=37564        Signed-off-by: David Korczynski <david@adalogics.com>
ad0c08590f	7e27589f3b	Tue Oct 19 16:24:19 2021 +0100	libsnmp: Fix a read-past-end-of-buffer	commit ad0c08590ff6eba880e493504d76a5e8bf8b78aaAuthor: David Korczynski <david@adalogics.com>Date:   Tue Oct 19 16:24:19 2021 +0100    libsnmp: Fix a read-past-end-of-buffer        Prevent that cp2 reads past end of the cp buffer. This patch fixes    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=36874        Signed-off-by: David Korczynski <david@adalogics.com>
d0891c58f9	e49f81d242	Fri Oct 15 09:39:19 2021 -0700	snmpd: Fix memory allocation	commit d0891c58f94520d302246534fcd97e41ec3f950fAuthor: David Korczynski <david@adalogics.com>Date:   Thu Oct 14 11:37:13 2021 +0100    snmpd: Fix memory allocation        Ensure memory allocation of more than 1 byte in case asp->vbcount is 0    Further clarification of this is found here:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=39901#c1        This also fixes    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=39930        Signed-off-by: David Korczynski <david@adalogics.com>
b9308221b1	416705ce8a	Sun Aug 29 09:29:05 2021 -0700	libsnmp: Fix more undefined behavior in asn_build_int()	commit b9308221b1d0c1f77c8b2511e196376dc2870211Author: Bart Van Assche <bvanassche@acm.org>Date:   Sun Aug 29 09:25:06 2021 -0700    libsnmp: Fix more undefined behavior in asn_build_int()        According to the C standard, triggering an overflow by shifting a signed    integer left results in undefined behavior. Fix this by inserting a cast.        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=37808
277d75633d	d700c957f9	Thu Aug 26 10:17:11 2021 -0700	libsnmp: Fix undefined behavior in asn_build_int()	commit 277d75633d8008cde468d026694289ca32f2cb6dAuthor: Bart Van Assche <bvanassche@acm.org>Date:   Thu Aug 26 10:17:11 2021 -0700    libsnmp: Fix undefined behavior in asn_build_int()        According to the C standard, triggering an overflow by shifting a signed    integer results in undefined behavior. Fix this by inserting a cast.        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=37579
5ecd04c215	359729bf94	Sat Aug 7 11:25:07 2021 -0700	libsnmp: Fix a read-past-end-of-buffer	commit 5ecd04c215f0cbe416434cb5ee0e36ec81a3a63fAuthor: Bart Van Assche <bvanassche@acm.org>Date:   Sat Aug 7 11:23:30 2021 -0700    libsnmp: Fix a read-past-end-of-buffer        Prevent that the code 'cp2 = cp + 1; *cp2' reads past the end of the input    buffer if the input buffer consists of one double quote. This patch should    fix https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=36874.
d0277ca1cc	20683e974b	Sat Aug 7 08:51:21 2021 -0700	libsnmp: Fix a memory leak in a MIB parser error path	commit d0277ca1ccd6ec8d786355a433717a9dbf41112eAuthor: Bart Van Assche <bvanassche@acm.org>Date:   Sat Aug 7 08:32:03 2021 -0700    libsnmp: Fix a memory leak in a MIB parser error path        This patch should fix    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=36879.
8b429a54b4	341eef1b98	Mon Jul 22 20:31:59 2019 -0700	AgentX: Fix an integer overflow	commit 8b429a54b495fb69aa2efa4f15a815aaedd69f0cAuthor: Bart Van Assche <bvanassche@acm.org>Date:   Mon Jul 22 19:48:16 2019 -0700    AgentX: Fix an integer overflow        Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=14502
