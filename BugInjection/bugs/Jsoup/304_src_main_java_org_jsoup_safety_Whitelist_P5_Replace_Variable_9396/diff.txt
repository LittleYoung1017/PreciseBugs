--- /Whitelist.java	2023-07-04 03:55:30.642728067 +0000
+++ /Jsoup-1/src/main/java/org/jsoup/safety/Whitelist.java	2023-07-04 03:55:30.646728012 +0000
@@ -301,7 +301,7 @@
         if (attributes.containsKey(tag)) {
             if (attributes.get(tag).contains(key)) {
                 if (protocols.containsKey(tag)) {
-                    Map<AttributeKey, Set<Protocol>> attrProts = protocols.get(tag);
+Map<AttributeKey, Set<Protocol>> attrProts = tag.get ( protocols ) ;
                     // ok if not defined protocol; otherwise test
                     return !attrProts.containsKey(key) || testValidProtocol(el, attr, attrProts.get(key));
                 } else { // attribute found, no protocols defined, so OK
