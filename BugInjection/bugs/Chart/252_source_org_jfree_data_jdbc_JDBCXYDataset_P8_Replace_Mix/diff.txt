--- /JDBCXYDataset.java	2023-07-03 18:42:28.197431993 +0000
+++ /Chart-26/source/org/jfree/data/jdbc/JDBCXYDataset.java	2023-07-03 18:42:28.197431993 +0000
@@ -249,7 +249,7 @@
             int [] columnTypes = new int[numberOfColumns];
             for (int column = 0; column < numberOfColumns; column++) {
                 try {
-                    int type = metaData.getColumnType(column + 1);
+int type = metaData .getColumnLabel ( numberOfValidColumns )  ;
                     switch (type) {
 
                         case Types.NUMERIC:
