openjpeg-20220812-be955619	be955619	49fea5c4	Fri Aug 12 15:48:41 2022 +0200	Fix Heap-buffer-overflow READ in opj_jp2_apply_pclr (#1441)	commit be95561917aa9b1d8ea4614820a534917cfa6bbeAuthor: Aleks L <93376818+sashashura@users.noreply.github.com>Date:   Fri Aug 12 14:48:41 2022 +0100    Fix Heap-buffer-overflow READ in opj_jp2_apply_pclr (#1441)        The issue was found while fuzzing opencv:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=47342        The read overflow triggered by reading `src[j]` in    ```cpp                for (j = 0; j < max; ++j) {                    dst[j] = src[j];                }    ```    The max is calculated as `new_comps[pcol].w * new_comps[pcol].h`, however the `src = old_comps[cmp].data;` which may have different `w` and `h` dimensions.	47342	src/lib/openjp2/jp2.c	1108
openjpeg-20220210-3837ff1b	3837ff1b	883c31db 1462e940	Thu Feb 10 15:13:49 2022 +0100	Merge pull request #1408 from rouault/fix_ossfuzz_44544	commit 3837ff1b1ac3ad81ec73024140a5e5eb1794123eMerge: 883c31db 1462e940Author: Even Rouault <even.rouault@spatialys.com>Date:   Thu Feb 10 15:13:49 2022 +0100    Merge pull request #1408 from rouault/fix_ossfuzz_44544        Avoid integer overflows in DWT. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=44544	44544	src/lib/openjp2/dwt.c	801
openjpeg-20220210-1462e940	1462e940	883c31db	Thu Feb 10 14:30:13 2022 +0100	Avoid integer overflows in DWT. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=44544	commit 1462e9403fb7d1186e999701dfe72980262a089cAuthor: Even Rouault <even.rouault@spatialys.com>Date:   Thu Feb 10 14:30:13 2022 +0100    Avoid integer overflows in DWT. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=44544	44544	src/lib/openjp2/dwt.c	801
openjpeg-20210903-badbd93a	badbd93a	172583ab	Fri Sep 3 15:17:56 2021 +0200	Avoid integer overflows in DWT. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=11700 and https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=30646	commit badbd93af92836c7a38ef069d410a829e2575ce2Author: Even Rouault <even.rouault@spatialys.com>Date:   Fri Sep 3 15:17:56 2021 +0200    Avoid integer overflows in DWT. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=11700 and https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=30646	11700	src/lib/openjp2/dwt.c;src/lib/openjp2/opj_intmath.h	385;450;796;2343;2484;276
openjpeg-20191117-4cb1f663	4cb1f663	5875a6b4	Sun Nov 17 01:18:26 2019 +0100	pi.c: avoid integer overflow, resulting in later invalid access to memory in opj_t2_decode_packets(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=18979	commit 4cb1f663049aab96e122d1ff16f601d0cc0be976Author: Even Rouault <even.rouault@spatialys.com>Date:   Sun Nov 17 01:18:26 2019 +0100    pi.c: avoid integer overflow, resulting in later invalid access to memory in opj_t2_decode_packets(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=18979	18979	src/lib/openjp2/pi.c;src/lib/openjp2/pi.h	376;508;639;102
openjpeg-20180620-41706816	41706816	0c913b0a	Wed Jun 20 15:28:53 2018 +0200	Add test cases for https://github.com/uclouvain/openjpeg/issues/1120 and https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2785	commit 4170681661126bc9c1348a0183633dc2f4fc8b05Author: Even Rouault <even.rouault@spatialys.com>Date:   Wed Jun 20 15:06:16 2018 +0200    Add test cases for https://github.com/uclouvain/openjpeg/issues/1120 and https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2785	2785	tests/nonregression/md5refs.txt;tests/nonregression/test_suite.ctest.in;tools/travis-ci/knownfailures-Ubuntu12.04-gcc4.6.3-i386-Release-3rdP.txt;tools/travis-ci/knownfailures-Ubuntu12.04-gcc4.6.4-i386-Release-3rdP.txt;tools/travis-ci/knownfailures-Ubuntu14.04-gcc4.8.4-i386-Release-3rdP.txt;tools/travis-ci/knownfailures-windows-vs2010-x86-Release-3rdP.txt	316;625;45;45;45;43
openjpeg-20180620-0c913b0a	0c913b0a	832dfd18	Wed Jun 20 15:12:47 2018 +0200	Avoid assertion when running opj_j2k_merge_ppt() several time due to e6674f7ed66abdb32a0be5944f618722b6a7b5d5 revert. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2785	commit 0c913b0aba409148b51ca43d45c50ae595449723Author: Even Rouault <even.rouault@spatialys.com>Date:   Wed Jun 20 14:54:09 2018 +0200    Avoid assertion when running opj_j2k_merge_ppt() several time due to e6674f7ed66abdb32a0be5944f618722b6a7b5d5 revert. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2785	2785	src/lib/openjp2/j2k.c	4094
openjpeg-20180620-832dfd18	832dfd18	fd205f45	Wed Jun 20 14:54:20 2018 +0200	Revert "Avoid assertion in opj_j2k_merge_ppt() in case premature EOC is encountered in opj_j2k_read_tile_header(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2785. Credit to OSS Fuzz" (fixes #1120)	commit 832dfd18665da08745748bde2d2563f00c7cd9e7Author: Even Rouault <even.rouault@spatialys.com>Date:   Wed Jun 20 14:38:41 2018 +0200    Revert "Avoid assertion in opj_j2k_merge_ppt() in case premature EOC is encountered in opj_j2k_read_tile_header(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2785. Credit to OSS Fuzz" (fixes #1120)        This reverts commit 9906fbf737692486cebabe98169988d818e2e66a.    which broke decoding of images where TNsot == 0	2785	src/lib/openjp2/j2k.c	8845
openjpeg-20170908-28094e1e	28094e1e	33167ddc	Fri Sep 8 10:56:49 2017 +0200	opj_tcd_mct_decode(): avoid heap buffer overflow when components have not the same number of resolutions. Also fixes an issue with subtile decoding. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3331. Credit to OSS Fuzz	commit 28094e1ebfa420f9a0bdc7a11b8d4ee5f154db35Author: Even Rouault <even.rouault@spatialys.com>Date:   Fri Sep 8 10:56:49 2017 +0200    opj_tcd_mct_decode(): avoid heap buffer overflow when components have not the same number of resolutions. Also fixes an issue with subtile decoding. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3331. Credit to OSS Fuzz	3331	src/lib/openjp2/tcd.c	1520;1973
openjpeg-20170907-cc893a4e	cc893a4e	c67e1cd7	Thu Sep 7 15:32:54 2017 +0200	opj_tcd_mct_decode(): fix checks to verify MCT can be done safely. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3305 (master only)	commit cc893a4ebfaf8c42cf1221ac82c83df91e77340bAuthor: Even Rouault <even.rouault@spatialys.com>Date:   Thu Sep 7 15:32:54 2017 +0200    opj_tcd_mct_decode(): fix checks to verify MCT can be done safely. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3305 (master only)	3305	src/lib/openjp2/tcd.c	1965
openjpeg-20170906-003759a4	003759a4	e656822f	Wed Sep 6 15:59:19 2017 +0200	Fix null pointer dereference on partial tile decoding when they are empty. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3297 (master only)	commit 003759a4829f3f1baa5a2292956618fecf314818Author: Even Rouault <even.rouault@spatialys.com>Date:   Wed Sep 6 15:59:19 2017 +0200    Fix null pointer dereference on partial tile decoding when they are empty. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3297 (master only)	3297	src/lib/openjp2/dwt.c	1931;2641
openjpeg-20170901-6ce49bf5	6ce49bf5	04b70908	Fri Sep 1 10:26:18 2017 +0200	Fix undefined shift behaviour in opj_dwt_is_whole_tile_decoding(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3255. Credit to OSS Fuzz	commit 6ce49bf5aebb3c45c464fa82d14cfd4bf7026a28Author: Even Rouault <even.rouault@spatialys.com>Date:   Fri Sep 1 10:26:18 2017 +0200    Fix undefined shift behaviour in opj_dwt_is_whole_tile_decoding(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3255. Credit to OSS Fuzz	3255	src/lib/openjp2/dwt.c	1218
openjpeg-20170828-a55c024f	a55c024f	8f92fc97	Mon Aug 28 17:18:33 2017 +0200	Subtile decoding: fix overflows in subband coordinate computation that cause later buffer overflow. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3115. Credit to OSS Fuzz. master only	commit a55c024fc6b917a409b85aeafd7326421c4aea34Author: Even Rouault <even.rouault@spatialys.com>Date:   Mon Aug 28 17:18:33 2017 +0200    Subtile decoding: fix overflows in subband coordinate computation that cause later buffer overflow. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3115. Credit to OSS Fuzz. master only	3115	src/lib/openjp2/dwt.c;src/lib/openjp2/tcd.c	1642;1711;2414
openjpeg-20170817-1ab6e0e0	1ab6e0e0	2cd30c2b	Thu Aug 17 12:01:16 2017 +0200	opj_decompress_fuzzer.cpp: reject images with too big tiles. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2918. Credit to OSS Fuzz	commit 1ab6e0e07a67193564811c5720a69cb28f09a809Author: Even Rouault <even.rouault@spatialys.com>Date:   Thu Aug 17 12:01:16 2017 +0200    opj_decompress_fuzzer.cpp: reject images with too big tiles. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2918. Credit to OSS Fuzz	2918	tests/fuzzers/opj_decompress_fuzzer.cpp	165
openjpeg-20170817-09e83407	09e83407	8e6c371e	Thu Aug 17 11:05:53 2017 +0200	Avoid asserting on assert(i == pcol) in opj_jp2_apply_pclr() by adding new check in opj_jp2_check_color(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3068. Credit to OSS Fuzz	commit 09e83407fa2b53c606d3179031b8d8b31272e20cAuthor: Even Rouault <even.rouault@spatialys.com>Date:   Thu Aug 17 11:05:53 2017 +0200    Avoid asserting on assert(i == pcol) in opj_jp2_apply_pclr() by adding new check in opj_jp2_check_color(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3068. Credit to OSS Fuzz	3068	src/lib/openjp2/jp2.c	958
openjpeg-20170804-2fbd4bb0	2fbd4bb0	155fc2e2	Fri Aug 4 18:02:10 2017 +0200	opj_j2k_read_sot(): check current TPSot number regarding previous (non-zero) TNsot to avoid opj_j2k_merge_ppt() to be called several times. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2851. Credit to OSS Fuzz	commit 2fbd4bb0b9c6178f12c852dc40db6ab05734bfe2Author: Even Rouault <even.rouault@spatialys.com>Date:   Fri Aug 4 18:01:29 2017 +0200    opj_j2k_read_sot(): check current TPSot number regarding previous (non-zero) TNsot to avoid opj_j2k_merge_ppt() to be called several times. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2851. Credit to OSS Fuzz	2851	src/lib/openjp2/j2k.c	4378
openjpeg-20170730-e23e0c94	e23e0c94	1ed8d677	Sun Jul 30 16:48:15 2017 +0200	Avoid p_stream->m_user_data_length >= (OPJ_UINT64)p_stream->m_byte_offset assertion in opj_stream_get_number_byte_left(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2786. Credit to OSS Fuzz	commit e23e0c94d0eb30623bc67be19c38c22ee5378344Author: Even Rouault <even.rouault@spatialys.com>Date:   Sun Jul 30 16:48:15 2017 +0200    Avoid p_stream->m_user_data_length >= (OPJ_UINT64)p_stream->m_byte_offset assertion in opj_stream_get_number_byte_left(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2786. Credit to OSS Fuzz	2786	src/lib/openjp2/cio.c;src/lib/openjp2/jp2.c	496;2367
openjpeg-20170730-1ed8d677	1ed8d677	68832af2	Sun Jul 30 15:35:47 2017 +0200	opj_j2k_set_decode_area: replace assertions by runtime checks. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2795. Credit to OSS Fuzz	commit 1ed8d67797ef57143e2c855b602016bf9d89337dAuthor: Even Rouault <even.rouault@spatialys.com>Date:   Sun Jul 30 15:35:47 2017 +0200    opj_j2k_set_decode_area: replace assertions by runtime checks. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2795. Credit to OSS Fuzz	2795	src/lib/openjp2/j2k.c	9062;9083;9101;9121
openjpeg-20170730-68832af2	68832af2	517bf6fd	Sun Jul 30 15:22:24 2017 +0200	opj_tcd_dc_level_shift_decode: avoid int32 overflow when prec == 31. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2799. Credit to OSS Fuzz	commit 68832af20e3b3710424947e12762b6b52d3b6ac0Author: Even Rouault <even.rouault@spatialys.com>Date:   Sun Jul 30 15:22:24 2017 +0200    opj_tcd_dc_level_shift_decode: avoid int32 overflow when prec == 31. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2799. Credit to OSS Fuzz	2799	src/lib/openjp2/tcd.c	1883
openjpeg-20170729-db9ef99f	db9ef99f	f6551f82	Sat Jul 29 16:34:35 2017 +0200	opj_t1_decode_cblk(): avoid undefined shift behaviour. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2487. Credit to OSS Fuzz	commit db9ef99f6dd054a84fa8382c02869fb0656abfc8Author: Even Rouault <even.rouault@spatialys.com>Date:   Sat Jul 29 16:34:35 2017 +0200    opj_t1_decode_cblk(): avoid undefined shift behaviour. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2487. Credit to OSS Fuzz	2487	src/lib/openjp2/t1.c	1822
openjpeg-20170729-f6551f82	f6551f82	9906fbf7	Sat Jul 29 16:29:11 2017 +0200	opj_t1_clbl_decode_processor(): avoid undefined behaviour if roishift >= 31. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2506. Credit to OSS Fuzz	commit f6551f822fe020843299bd807ec6989abd070b2cAuthor: Even Rouault <even.rouault@spatialys.com>Date:   Sat Jul 29 16:29:11 2017 +0200    opj_t1_clbl_decode_processor(): avoid undefined behaviour if roishift >= 31. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2506. Credit to OSS Fuzz	2506	src/lib/openjp2/t1.c	1685
openjpeg-20170729-9906fbf7	9906fbf7	71b4f5b1	Sat Jul 29 16:22:36 2017 +0200	Avoid assertion in opj_j2k_merge_ppt() in case premature EOC is encountered in opj_j2k_read_tile_header(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2785. Credit to OSS Fuzz	commit 9906fbf737692486cebabe98169988d818e2e66aAuthor: Even Rouault <even.rouault@spatialys.com>Date:   Sat Jul 29 16:22:36 2017 +0200    Avoid assertion in opj_j2k_merge_ppt() in case premature EOC is encountered in opj_j2k_read_tile_header(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2785. Credit to OSS Fuzz	2785	src/lib/openjp2/j2k.c	8618
openjpeg-20170729-71b4f5b1	71b4f5b1	d6654d90	Sat Jul 29 15:52:11 2017 +0200	opj_pi_next_pcrl(): avoid undefined shift behaviour. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2787. Credit to OSS Fuzz	commit 71b4f5b124d14ed609763b11e19d2d480bc32f58Author: Even Rouault <even.rouault@spatialys.com>Date:   Sat Jul 29 15:52:11 2017 +0200    opj_pi_next_pcrl(): avoid undefined shift behaviour. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2787. Credit to OSS Fuzz	2787	src/lib/openjp2/pi.c	526
openjpeg-20170728-d6654d90	d6654d90	361c4506	Fri Jul 28 22:15:47 2017 +0200	opj_int_ceildiv(): fix int32 overflow. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2494. Credit to OSS Fuzz	commit d6654d906c1ae66590b6d600458a91f1ee923de5Author: Even Rouault <even.rouault@spatialys.com>Date:   Fri Jul 28 22:15:47 2017 +0200    opj_int_ceildiv(): fix int32 overflow. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2494. Credit to OSS Fuzz	2494	src/lib/openjp2/opj_intmath.h	129
openjpeg-20170728-361c4506	361c4506	7bdbe490	Fri Jul 28 22:06:26 2017 +0200	opj_tcd_dc_level_shift_decode(): avoid int overflow. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2516. Credit to OSS Fuzz	commit 361c4506fdfb9b6f0e41d86d5d0ea1efb5704ecfAuthor: Even Rouault <even.rouault@spatialys.com>Date:   Fri Jul 28 22:06:26 2017 +0200    opj_tcd_dc_level_shift_decode(): avoid int overflow. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2516. Credit to OSS Fuzz	2516	src/lib/openjp2/tcd.c	1890
openjpeg-20170728-7bdbe490	7bdbe490	16aeb928	Fri Jul 28 21:55:22 2017 +0200	Fix null pointer dereference in opj_jp2_apply_pclr(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2558. Credit to OSS Fuzz	commit 7bdbe490cba9990916f94a40379cc787434340ffAuthor: Even Rouault <even.rouault@spatialys.com>Date:   Fri Jul 28 21:55:22 2017 +0200    Fix null pointer dereference in opj_jp2_apply_pclr(). Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2558. Credit to OSS Fuzz	2558	src/lib/openjp2/jp2.c	270;1009;1026;1051;1068;1110;1597;3069
openjpeg-20170726-a88cbb6a	a88cbb6a	6c5fe940	Wed Jul 26 22:53:59 2017 +0200	Fix various undefined shift behaviour in pi.c	commit a88cbb6a0b3539461dfb29922102953b7a7fc3a7Author: Even Rouault <even.rouault@spatialys.com>Date:   Wed Jul 26 22:53:59 2017 +0200    Fix various undefined shift behaviour in pi.c        Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=2496    Credit to OSS Fuzz	2496	src/lib/openjp2/pi.c	353;386;472;591;617;896
