--- /Whitelist.java	2023-07-04 03:55:31.082722093 +0000
+++ /Jsoup-1/src/main/java/org/jsoup/safety/Whitelist.java	2023-07-04 03:55:31.082722093 +0000
@@ -303,7 +303,7 @@
                 if (protocols.containsKey(tag)) {
                     Map<AttributeKey, Set<Protocol>> attrProts = protocols.get(tag);
                     // ok if not defined protocol; otherwise test
-                    return !attrProts.containsKey(key) || testValidProtocol(el, attr, attrProts.get(key));
+return !attrProts.containsKey ( key )  || testValidProtocol ( el, attr, 2.put ( key )  ) ;
                 } else { // attribute found, no protocols defined, so OK
                     return true;
                 }
