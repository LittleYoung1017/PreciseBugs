5267858b	2bbde5ba	Sat Jul 15 22:23:52 2023 +0200	HTTP: fix another memory access error (#2049)	commit 5267858b3d09fbc6a70c4bdcabdd176ea26ee72cAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Sat Jul 15 22:23:52 2023 +0200    HTTP: fix another memory access error (#2049)        ```    =================================================================    ==199079==ERROR: AddressSanitizer: negative-size-param: (size=-1)        #0 0x559a2a6efd4f in strncpy (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader+0x94ad4f) (BuildId: 34aaabba403c6bc5482553ef355360fd2762a157)        #1 0x559a2a9890f0 in ndpi_http_check_content /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:300:8        #2 0x559a2a9812c0 in check_content_type_and_change_protocol /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:910:46        #3 0x559a2a978fee in process_response /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1289:3        #4 0x559a2a97622f in ndpi_check_http_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1382:9        #5 0x559a2a975d95 in ndpi_search_http_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1468:3        #6 0x559a2a864970 in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5948:4        #7 0x559a2a8660df in check_ndpi_tcp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6013:12        #8 0x559a2a865d7f in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6032:12        #9 0x559a2a876fd6 in ndpi_internal_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:7038:15        #10 0x559a2a87311f in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:7205:22        #11 0x559a2a77381e in packet_processing /home/ivan/svnrepos/nDPI/fuzz/../example/reader_util.c:1710:31        #12 0x559a2a77381e in ndpi_workflow_process_packet /home/ivan/svnrepos/nDPI/fuzz/../example/reader_util.c:2427:10    [...]    ```        Found by oss-fuzz    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=60605
bd0fcb2e	0c5a17ac	Thu Jul 13 10:50:59 2023 +0200	HTTP: fix heap-buffer-overflow (#2044)	commit bd0fcb2e62e5fa1fb3f4342e605e15f1f4920efcAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Thu Jul 13 10:50:59 2023 +0200    HTTP: fix heap-buffer-overflow (#2044)        ```    =================================================================    ==673246==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x5080000002fd at pc 0x555c6a22eca2 bp 0x7ffe1db9b290 sp 0x7ffe1db9aa48    READ of size 1 at 0x5080000002fd thread T0        #0 0x555c6a22eca1 in strncpy (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet+0x53aca1) (BuildId: 464e7474cde3de91c01588c7ea0161a05ddd6b63)        #1 0x555c6a462a9d in ndpi_http_check_content /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:309:8        #2 0x555c6a45a9a0 in check_content_type_and_change_protocol /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:901:46        #3 0x555c6a4526ce in process_response /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1280:3        #4 0x555c6a44f90f in ndpi_check_http_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1373:9        #5 0x555c6a44f475 in ndpi_search_http_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1459:3        #6 0x555c6a348520 in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5949:6        #7 0x555c6a348f2f in check_ndpi_tcp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5997:12        #8 0x555c6a348bcf in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6016:12        #9 0x555c6a359e26 in ndpi_internal_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:7017:15        #10 0x555c6a355f6f in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:7184:22        #11 0x555c6a284958 in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:24:5    ```        Found by oss-fuzz.    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=60557    Fix: 0b0f255cc
efb261a9	346bb268	Mon May 29 19:24:00 2023 +0200	Fix some memory errors triggered by allocation failures (#1995)	commit efb261a95c5a81ddb148f205d74eab3714155f0dAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Mon May 29 19:24:00 2023 +0200    Fix some memory errors triggered by allocation failures (#1995)        Some low hanging fruits found using nallocfuzz.    See: https://github.com/catenacyber/nallocfuzz    See: https://github.com/google/oss-fuzz/pull/9902        Most of these errors are quite trivial to fix; the only exception is the    stuff in the uthash.    If the insertion fails (because of an allocation failure), we need to    avoid some memory leaks. But the only way to check if the `HASH_ADD_*`    failed, is to perform a new lookup: a bit costly, but we don't use that    code in any critical data-path.
82fa3a09	46ff0691	Mon May 29 16:53:39 2023 +0200	Fix an heap-buffer-overflow (#1994)	commit 82fa3a098632006cc8edffb647cabee08843524aAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Mon May 29 16:53:39 2023 +0200    Fix an heap-buffer-overflow (#1994)        ```    ==32439==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x604000000080 at pc 0x564a9a1639ac bp 0x7ffc77d42e20 sp 0x7ffc77d42e18    READ of size 1 at 0x604000000080 thread T0        #0 0x564a9a1639ab in ndpi_check_punycode_string /home/ivan/svnrepos/nDPI/src/lib/ndpi_utils.c:98:12        #1 0x564a9a26025a in ndpi_match_host_subprotocol /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:8652:6        #2 0x564a9a33e45c in ndpi_http_parse_subprotocol /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:446:9        #3 0x564a9a3354b8 in check_content_type_and_change_protocol /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:921:3        #4 0x564a9a32dc8b in process_request /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1237:3        #5 0x564a9a329a9c in ndpi_check_http_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1351:5        #6 0x564a9a3293ed in ndpi_search_http_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1425:3        #7 0x564a9a21c64a in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5906:6        #8 0x564a9a21d057 in check_ndpi_tcp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5954:12    ```        Found by oss-fuzzer.    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=59393
04a426fe	ddb9aa0f	Sat Mar 25 19:19:51 2023 +0100	ndpiReader: fix VXLAN de-tunneling (#1913)	commit 04a426feef3399a2354b4aa10ee2a28cf107fb45Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Sat Mar 25 19:19:51 2023 +0100    ndpiReader: fix VXLAN de-tunneling (#1913)        ```    ==20665==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6040000aec81 at pc 0x0000004f5c6f bp 0x7fff07e9e1f0 sp 0x7fff07e9e1e8    READ of size 1 at 0x6040000aec81 thread T0    SCARINESS: 12 (1-byte-read-heap-buffer-overflow)        #0 0x4f5c6e in ndpi_is_valid_vxlan ndpi/example/reader_util.c:1784:6        #1 0x4f5c6e in ndpi_workflow_process_packet ndpi/example/reader_util.c:2292:16        #2 0x4dd821 in LLVMFuzzerTestOneInput ndpi/fuzz/fuzz_ndpi_reader.c:135:7        #3 0x4f91ba in ExecuteFilesOnyByOne /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:234:7        #4 0x4f8f8c in main /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:318:12        #5 0x7f2289324082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/libc-start.c:308:16        #6 0x41e6cd in _start    ```    Found by oss-fuzz.    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=57369
ddb9aa0f	530d0de4	Wed Mar 22 18:18:36 2023 +0100	TLS: fix parsing of certificate elements (#1910)	commit ddb9aa0f95ba263361b9be2ba0a122ea1e001be9Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Wed Mar 22 18:18:36 2023 +0100    TLS: fix parsing of certificate elements (#1910)        ```    ==1228==ERROR: AddressSanitizer: SEGV on unknown address 0x6040000bed05 (pc 0x00000056e148 bp 0x7ffcca534320 sp 0x7ffcca5330c0 T0)    ==1228==The signal is caused by a WRITE memory access.        #0 0x56e148 in processCertificateElements ndpi/src/lib/protocols/tls.c:682:79        #1 0x56c60f in LLVMFuzzerTestOneInput ndpi/fuzz/fuzz_tls_certificate.c:43:3        #2 0x43de63 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15        #3 0x4295c2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6        #4 0x42ee6c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9        #5 0x4583a2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10        #6 0x7f8c021c9082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/libc-start.c:308:16        #7 0x41f78d in _start    ```        Found by oss-fuzz.    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=57317
9eb96645	127d8d0d	Wed Mar 1 20:34:56 2023 +0100	SoftEther: fix invalid memory access	commit 9eb9664516aafb821097f049717c70e576ac18a6Author: Nardi Ivan <nardi.ivan@gmail.com>Date:   Thu Feb 23 14:33:41 2023 +0100    SoftEther: fix invalid memory access        We can't write `flow->protos` union until we are really sure about protocol    classification        ```    ==28334==ERROR: AddressSanitizer: SEGV on unknown address (pc 0x558db5554512 bp 0x000000000000 sp 0x7ffcb22c2880 T0)    ==28334==The signal is caused by a READ memory access.    ==28334==Hint: this fault was caused by a dereference of a high value address (see register values below).  Disassemble the provided pc to learn which register was used.        #0 0x558db5554512 in __asan::Allocator::Deallocate(void*, unsigned long, unsigned long, __sanitizer::BufferedStackTrace*, __asan::AllocType) (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet+0x48e512) (BuildId: 2f71e395637a7b748f36d5a04c7281f18b1128d7)        #1 0x558db55ea54b in __interceptor_free (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet+0x52454b) (BuildId: 2f71e395637a7b748f36d5a04c7281f18b1128d7)        #2 0x558db56977ca in ndpi_free /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:274:7        #3 0x558db56c20e3 in ndpi_free_flow_data /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5175:2        #4 0x558db569783f in ndpi_free_flow /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:8394:5        #5 0x558db5627936 in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:38:3    ```        Found by oss-fuzz    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=56272
f5c2f928	f95bdaf6	Thu Jan 19 14:13:17 2023 +0100	Fix undefined-behaviour in ahocorasick callback (#1864)	commit f5c2f9280cbf06b716a5849cc4f9005a37c49f19Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Thu Jan 19 14:13:17 2023 +0100    Fix undefined-behaviour in ahocorasick callback (#1864)        ```    ndpi_main.c:2119:28: runtime error: left shift of 1 by 31 places cannot be represented in type 'int'    ```    Found by oss-fuzz    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=55226
f95bdaf6	edb8165a	Thu Jan 19 14:12:51 2023 +0100	Bittorrent: fix heap-buffer-overflow (#1863)	commit f95bdaf625a540cbd040508bfbb8808223f97aedAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Thu Jan 19 14:12:51 2023 +0100    Bittorrent: fix heap-buffer-overflow (#1863)        ```    ==258287==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60600068ff9d at pc 0x5653a6e35def bp 0x7ffeef5aa620 sp 0x7ffeef5a9dc8    READ of size 22 at 0x60600068ff9d thread T0        #0 0x5653a6e35dee in strncmp (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader+0x4d2dee) (BuildId: 133b8c3c8ff99408109fcb9be2538bb8341f07f7)        #1 0x5653a70d6624 in ndpi_search_bittorrent /home/ivan/svnrepos/nDPI/src/lib/protocols/bittorrent.c:500:71        #2 0x5653a6ff255a in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5686:6        #3 0x5653a6ff331b in check_ndpi_udp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5722:10        #4 0x5653a6ff2cbc in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5755:12        #5 0x5653a70016bf in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6578:15        #6 0x5653a6f1836d in packet_processing /home/ivan/svnrepos/nDPI/fuzz/../example/reader_util.c:1678:31        #7 0x5653a6f140a1 in ndpi_workflow_process_packet /home/ivan/svnrepos/nDPI/fuzz/../example/reader_util.c:2256:10    ```    Found by oss-fuzz    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=55218    Fix: 470eaa6f
5a5e01a9	663df7e4	Thu Jan 5 16:41:53 2023 +0100	PPSTREAM: fix some heap-buffer overflows (#1846)	commit 5a5e01a9e2b66e9238c40583baa70341e9ffc3a5Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Thu Jan 5 16:41:53 2023 +0100    PPSTREAM: fix some heap-buffer overflows (#1846)        Found by oss-fuzz    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=54802
9c83f0f3	cb15d2b3	Tue Jan 3 13:21:54 2023 +0100	Fix some warnings and two errors found while fuzzing (#1844)	commit 9c83f0f3c590a896a5edf185040cbfeee8eb10a6Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Tue Jan 3 13:21:54 2023 +0100    Fix some warnings and two errors found while fuzzing (#1844)        Fix CI    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=54614
22821241	fa67166f	Tue Dec 20 22:50:18 2022 +0100	Fix some errors found by oss-fuzz (#1834)	commit 22821241e2abff6d33f192992b956a119e516cafAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Tue Dec 20 22:50:18 2022 +0100    Fix some errors found by oss-fuzz (#1834)
9f7ef723	6004e55d	Sat Dec 10 09:18:36 2022 +0100	fuzz: fix signed-integer-overflow (#1822)	commit 9f7ef723327647813a369ab55336845cc7c1b0abAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Sat Dec 10 09:18:36 2022 +0100    fuzz: fix signed-integer-overflow (#1822)        ```    fuzz_ndpi_reader.c:33:29: runtime error: signed integer overflow: 214013 * 24360337 cannot be represented in type 'int'        #0 0x4c1cf7 in fastrand ndpi/fuzz/fuzz_ndpi_reader.c:33:29        #1 0x4c1cf7 in malloc_wrapper ndpi/fuzz/fuzz_ndpi_reader.c:38:11        #2 0x523057 in ndpi_malloc ndpi/src/lib/ndpi_main.c:220:25    ```    Found by oss-fuzz    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=54112
2d153fba	6c84ce85	Fri Oct 14 18:59:33 2022 +0000	HTTP: fix stack-buffer-overflow (#1768)	commit 2d153fba45325e4fe716ff92a44eb67fe0fcea72Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Fri Oct 14 20:59:33 2022 +0200    HTTP: fix stack-buffer-overflow (#1768)        ```    ==24879==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fa085b31e60 at pc 0x55cc63f203e2 bp 0x7ffc9ec91b10 sp 0x7ffc9ec91298    READ of size 17 at 0x7fa085b31e60 thread T0        #0 0x55cc63f203e1 in printf_common(void*, char const*, __va_list_tag*) asan_interceptors.cpp.o        #1 0x55cc63f20769 in vsnprintf (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x50e769) (BuildId: cce2b6b1344bfd0bdc9626fef604c2b3caad485b)        #2 0x55cc63f22210 in __interceptor_snprintf (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x510210) (BuildId: cce2b6b1344bfd0bdc9626fef604c2b3caad485b)        #3 0x55cc6420fc76 in ndpi_check_http_server /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:668:4        #4 0x55cc6420344b in check_content_type_and_change_protocol /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:742:5        #5 0x55cc642031ce in check_content_type_and_change_protocol /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:737:7        #6 0x55cc641fac9f in ndpi_check_http_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1352:4        #7 0x55cc641f2fd5 in ndpi_search_http_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1461:3        #8 0x55cc64085275 in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5580:6        #9 0x55cc64085c87 in check_ndpi_tcp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5628:12        #10 0x55cc64085927 in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5647:12        #11 0x55cc64095fcb in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6458:15        #12 0x55cc63fd08b4 in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:29:5        #13 0x55cc63fd09f7 in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:101:17        #14 0x7fa0880fb082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16        #15 0x55cc63efb45d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x4e945d) (BuildId: cce2b6b1344bfd0bdc9626fef604c2b3caad485b)        Address 0x7fa085b31e60 is located in stack of thread T0 at offset 96 in frame        #0 0x55cc6420f1bf in ndpi_check_http_server /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:644          This frame has 5 object(s):        [32, 36) 'a' (line 653)        [48, 52) 'b' (line 653)        [64, 68) 'c' (line 653)        [80, 96) 'buf' (line 654)        [112, 176) 'msg' (line 662) <== Memory access at offset 96 partially underflows this variable        ```    Found by oss-fuzzer    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=52229
ac0d7ccb	a53f4765	Mon Aug 22 17:53:52 2022 +0200	HTTP, SoftEther, Florensia: fix some memory corruptions	commit ac0d7ccb7e6ee1a9b67f07822dad66617d5ff75bAuthor: Nardi Ivan <nardi.ivan@gmail.com>Date:   Mon Aug 22 17:00:40 2022 +0200    HTTP, SoftEther, Florensia: fix some memory corruptions        ```    ==12308==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60600068f4b4 at pc 0x5603d2b56098 bp 0x7ffc967bd3b0 sp 0x7ffc967bd3a8    READ of size 2 at 0x60600068f4b4 thread T0        #0 0x5603d2b56097 in ndpi_search_florensia /home/ivan/svnrepos/nDPI/src/lib/protocols/florensia.c:93:40        #1 0x5603d2a2e835 in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5414:6        #2 0x5603d2a2f247 in check_ndpi_tcp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5462:12        #3 0x5603d2a2eee7 in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5481:12        #4 0x5603d2a3ffb5 in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6308:15        #5 0x5603d2955f4c in packet_processing /home/ivan/svnrepos/nDPI/example/reader_util.c:1612:31        #6 0x5603d294ee64 in ndpi_workflow_process_packet /home/ivan/svnrepos/nDPI/example/reader_util.c:2182:10        #7 0x5603d290aa50 in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:107:7        #8 0x5603d290ab8b in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:179:17        #9 0x7f972cdc9082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16        #10 0x5603d28494fd in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader_with_main+0x4be4fd) (BuildId: e81373a75c70e248ba9ae985fcb4134e7113121a)    ```    ```    ==14164==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60d0000000c1 at pc 0x561608bada2c bp 0x7ffc40d38ed0 sp 0x7ffc40d38690    READ of size 10 at 0x60d0000000c1 thread T0        #0 0x561608bada2b in __interceptor_strncpy (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x4e9a2b) (BuildId: 2e4fd67f1aeb93c491a04ae424331669c993ee9b)        #1 0x561608e66f2a in dissect_softether_host_fqdn /home/ivan/svnrepos/nDPI/src/lib/protocols/softether.c:226:2        #2 0x561608e64e88 in ndpi_search_softether /home/ivan/svnrepos/nDPI/src/lib/protocols/softether.c:316:8        #3 0x561608ca7475 in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5414:6        #4 0x561608ca823b in check_ndpi_udp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5450:10        #5 0x561608ca7bdc in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5483:12        #6 0x561608cb8bf5 in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6308:15        #7 0x561608bff84e in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:29:5        #8 0x561608bff9c7 in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:101:17        #9 0x7fc50662d082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16        #10 0x561608b3e42d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x47a42d) (BuildId: 2e4fd67f1aeb93c491a04ae424331669c993ee9b)    ```        Found by oss-fuzzer.    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=50105    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=50110    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=50268
540848c2	59a9bdeb	Tue Aug 9 18:41:10 2022 +0200	HTTP: fix classification in some corner cases (#1704)	commit 540848c254ab4f8f89b6cfab03269ed8dc4dc887Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Tue Aug 9 18:41:10 2022 +0200    HTTP: fix classification in some corner cases (#1704)        Initializing `low->detected_protocol_stack[1]` but not    `low->detected_protocol_stack[0]` lead to *very* strange errors.    Oss-fuzzer, exploiting this bug, has been able to crash the application    or to leak some memory        ```    ==19775==ERROR: AddressSanitizer: SEGV on unknown address (pc 0x5624c0dd1802 bp 0x5624c197e848 sp 0x7fff4b4db690 T0)    ==19775==The signal is caused by a READ memory access.    ==19775==Hint: this fault was caused by a dereference of a high value address (see register values below).  Disassemble the provided pc to learn which register was used.        #0 0x5624c0dd1802 in __asan::Allocator::Deallocate(void*, unsigned long, unsigned long, __sanitizer::BufferedStackTrace*, __asan::AllocType) (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader_with_main+0x522802) (BuildId: 9a1ed9efcaf47e345767c86520372d28e31ca1aa)        #1 0x5624c0e53ea6 in __interceptor_free (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader_with_main+0x5a4ea6) (BuildId: 9a1ed9efcaf47e345767c86520372d28e31ca1aa)        #2 0x5624c0ebb474 in free_wrapper /home/ivan/svnrepos/nDPI/example/reader_util.c:330:3        #3 0x5624c0f75561 in ndpi_free /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:240:7        #4 0x5624c0faa921 in ndpi_free_flow_data /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:4915:2        #5 0x5624c0f755ef in ndpi_free_flow /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:8076:5        #6 0x5624c0f755c4 in ndpi_flow_free /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:253:5        #7 0x5624c0eba981 in ndpi_free_flow_info_half /home/ivan/svnrepos/nDPI/example/reader_util.c:305:25        #8 0x5624c0ecb4bc in process_ndpi_collected_info /home/ivan/svnrepos/nDPI/example/reader_util.c:1317:5        #9 0x5624c0edca36 in packet_processing /home/ivan/svnrepos/nDPI/example/reader_util.c:1639:2        #10 0x5624c0ed5172 in ndpi_workflow_process_packet /home/ivan/svnrepos/nDPI/example/reader_util.c:2182:10        #11 0x5624c0e90a80 in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:107:7        #12 0x5624c0e90bbb in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:179:17        #13 0x7f580731f082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16        #14 0x5624c0dcf52d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader_with_main+0x52052d) (BuildId: 9a1ed9efcaf47e345767c86520372d28e31ca1aa)    ```        ```    ==17492==ERROR: LeakSanitizer: detected memory leaks        Direct leak of 5 byte(s) in 1 object(s) allocated from:        #0 0x55b799b0f01e in malloc (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x56101e) (BuildId: d2adbfb29a6eda6dc59fdfb8930d7e6496ac7b8b)        #1 0x55b799bb3bf4 in ndpi_malloc /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:212:46        #2 0x55b799bb3f28 in ndpi_strdup /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:279:13        #3 0x55b799c8b9bf in processCertificateElements /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:683:39        #4 0x55b799c81e89 in processCertificate /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:835:7        #5 0x55b799c8d500 in processTLSBlock /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:889:13        #6 0x55b799ca80f1 in ndpi_search_tls_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:1034:2        #7 0x55b799ca3be2 in ndpi_search_tls_wrapper /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:2475:5        #8 0x55b799bf9345 in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5414:6        #9 0x55b799bf9d57 in check_ndpi_tcp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5462:12        #10 0x55b799bf99f7 in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5481:12        #11 0x55b799c0b838 in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6308:15        #12 0x55b799b4b87e in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:29:5    ```        ```    ==17511==ERROR: LeakSanitizer: detected memory leaks        Direct leak of 1 byte(s) in 1 object(s) allocated from:        #0 0x55aed645e01e in malloc (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x56101e) (BuildId: d2adbfb29a6eda6dc59fdfb8930d7e6496ac7b8b)        #1 0x55aed6502bf4 in ndpi_malloc /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:212:46        #2 0x55aed6502f28 in ndpi_strdup /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:279:13        #3 0x55aed65ea0c6 in processClientServerHello /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:2153:34        #4 0x55aed65dbe77 in processTLSBlock /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:867:5        #5 0x55aed65f70f1 in ndpi_search_tls_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:1034:2        #6 0x55aed65f2be2 in ndpi_search_tls_wrapper /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:2475:5        #7 0x55aed6548345 in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5414:6        #8 0x55aed6548d57 in check_ndpi_tcp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5462:12        #9 0x55aed65489f7 in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5481:12        #10 0x55aed655a838 in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6308:15        #11 0x55aed649a87e in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:29:5    ```        See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=49844    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=49842    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=49906    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=49915
59a9bdeb	2e25c363	Tue Aug 9 18:09:16 2022 +0200	SoftEtehr: fix a heap-buffer overflow (#1705)	commit 59a9bdeb55fb5a712b51141bfa4492a897cda5c8Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Tue Aug 9 18:09:16 2022 +0200    SoftEtehr: fix a heap-buffer overflow (#1705)        ```    ==26717==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60c0000000bf at pc 0x55e503f8959b bp 0x7fff7f6876b0 sp 0x7fff7f686e58    READ of size 1 at 0x60c0000000bf thread T0        #0 0x55e503f8959a in strncmp (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x4f459a) (BuildId: 44038d7ca9391c877fae9b2735828da9905a6daa)        #1 0x55e5042ee98f in dissect_softether_host_fqdn /home/ivan/svnrepos/nDPI/src/lib/protocols/softether.c:236:8        #2 0x55e5042ec41b in ndpi_search_softether /home/ivan/svnrepos/nDPI/src/lib/protocols/softether.c:318:8        #3 0x55e5040e0345 in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5414:6        #4 0x55e5040e110b in check_ndpi_udp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5450:10        #5 0x55e5040e0aac in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5483:12        #6 0x55e5040f2838 in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6308:15        #7 0x55e50403287e in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:29:5        #8 0x55e5040329f7 in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:101:17        #9 0x7fd09fdbb082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16        #10 0x55e503f7145d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x4dc45d) (BuildId: 44038d7ca9391c877fae9b2735828da9905a6daa)    ```        Found by oss-fuzzer    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=49901
346e274a	10f283b4	Fri Aug 5 13:43:09 2022 +0200	SoftEther: fix two heap-buffer-overflows (#1695)	commit 346e274a1b1d713aedfc341f7d1300009f9f0e1aAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Fri Aug 5 13:43:09 2022 +0200    SoftEther: fix two heap-buffer-overflows (#1695)        The first change is a proper (hopefully) fix for the bug reported in    8b6a00f8.    The second one is related to:    ```    ==15096==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60f0000d7a00 at pc 0x55a2c593bd0b bp 0x7ffc92021cd0 sp 0x7ffc92021478    READ of size 3 at 0x60f0000d7a00 thread T0        #0 0x55a2c593bd0a in strncmp (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader+0x56fd0a) (BuildId: ee8631c0950a8cded5ba60c17f09709bbebbe5d8)        #1 0x55a2c5d1d9f9 in dissect_softether_host_fqdn /home/ivan/svnrepos/nDPI/src/lib/protocols/softether.c:249:9        #2 0x55a2c5d1b55b in ndpi_search_softether /home/ivan/svnrepos/nDPI/src/lib/protocols/softether.c:348:9        #3 0x55a2c5b0e9c5 in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5407:6        #4 0x55a2c5b0f78b in check_ndpi_udp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5443:10        #5 0x55a2c5b0f12c in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5476:12        #6 0x55a2c5b20f39 in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6303:15        #7 0x55a2c5a3014c in packet_processing /home/ivan/svnrepos/nDPI/example/reader_util.c:1600:31        #8 0x55a2c5a29062 in ndpi_workflow_process_packet /home/ivan/svnrepos/nDPI/example/reader_util.c:2170:10        #9 0x55a2c59e51a2 in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:107:7        #10 0x55a2c590acb2 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader+0x53ecb2) (BuildId: ee8631c0950a8cded5ba60c17f09709bbebbe5d8)        #11 0x55a2c590a3c5 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader+0x53e3c5) (BuildId: ee8631c0950a8cded5ba60c17f09709bbebbe5d8)        #12 0x55a2c590c0f6 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader+0x5400f6) (BuildId: ee8631c0950a8cded5ba60c17f09709bbebbe5d8)        #13 0x55a2c590c663 in fuzzer::Fuzzer::Loop(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader+0x540663) (BuildId: ee8631c0950a8cded5ba60c17f09709bbebbe5d8)        #14 0x55a2c58faff2 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader+0x52eff2) (BuildId: ee8631c0950a8cded5ba60c17f09709bbebbe5d8)        #15 0x55a2c5923c82 in main (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader+0x557c82) (BuildId: ee8631c0950a8cded5ba60c17f09709bbebbe5d8)        #16 0x7f504ab98082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16        #17 0x55a2c58efb1d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader+0x523b1d) (BuildId: ee8631c0950a8cded5ba60c17f09709bbebbe5d8)        0x60f0000d7a00 is located 0 bytes to the right of 176-byte region [0x60f0000d7950,0x60f0000d7a00)    ```    Found by oss-fuzzer    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=49736
8b6a00f8	d54d5083	Sat Jul 30 22:55:46 2022 +0200	SoftEther: fix heap-buffer-overflow (#1691)	commit 8b6a00f84bff9c998643d823502ae9f924fce528Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Sat Jul 30 22:55:46 2022 +0200    SoftEther: fix heap-buffer-overflow (#1691)        ```    ==160665==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x604000000038 at pc 0x55f7250d9a5c bp 0x7fff02c82b90 sp 0x7fff02c82350    READ of size 4 at 0x604000000038 thread T0        #0 0x55f7250d9a5b in __interceptor_strncpy (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x548a5b) (BuildId: 12fd06e7a171f035d3a25f016184ac357088379c)        #1 0x55f7253e6495 in dissect_softether_ip_port /home/ivan/svnrepos/nDPI/src/lib/protocols/softether.c:303:3        #2 0x55f7253e5703 in ndpi_search_softether /home/ivan/svnrepos/nDPI/src/lib/protocols/softether.c:330:9        #3 0x55f7251d87c5 in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5397:6        #4 0x55f7251d958b in check_ndpi_udp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5433:10        #5 0x55f7251d8f2c in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5466:12        #6 0x55f7251ead39 in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6293:15        #7 0x55f72512b87e in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:29:5        #8 0x55f72512b9f7 in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:101:17        #9 0x7fdef837b082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16        #10 0x55f72506a45d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x4d945d) (BuildId: 12fd06e7a171f035d3a25f016184ac357088379c)    ```        Found by oss-fuzz.    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=49638
40715575	9c235796	Tue Jul 12 18:39:05 2022 +0200	ASN1/BER: fix signed integer overflow (#1660)	commit 407155755da29734e9b8a8e7a6960c568b1d3188Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Tue Jul 12 18:39:05 2022 +0200    ASN1/BER: fix signed integer overflow (#1660)        ```    protocols/snmp_proto.c:77:23: runtime error: signed integer overflow: 6 + 2147483647 cannot be represented in type 'int'     #0 0x52f69e in ndpi_search_snmp ndpi/src/lib/protocols/snmp_proto.c:77:23     #1 0x4c5347 in check_ndpi_detection_func ndpi/src/lib/ndpi_main.c:5211:4     #2 0x4c5591 in ndpi_check_flow_func ndpi/src/lib/ndpi_main.c:0     #3 0x4c8903 in ndpi_detection_process_packet ndpi/src/lib/ndpi_main.c:6145:15     #4 0x4b3712 in LLVMFuzzerTestOneInput ndpi/fuzz/fuzz_process_packet.c:29:5    [...]    ```    Found by oss-fuzzer.    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=49057
bdf54d72	8dcaa5c0	Tue Jun 14 11:44:32 2022 +0200	Fix invalid memory access (#1596)	commit bdf54d725bb3e751b63af171e08203e3e434c587Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Tue Jun 14 11:44:32 2022 +0200    Fix invalid memory access (#1596)        We can access `flow->protos` union only after checking the protocol.        Checking `flow->detected_protocol.master_protocol` is redundant because    we already check it in `is_ndpi_proto`        ```    AddressSanitizer:DEADLYSIGNAL    =================================================================    ==29739==ERROR: AddressSanitizer: SEGV on unknown address 0x000000353820 (pc 0x7f9b64dd2717 bp 0x7fff161a52f0 sp 0x7fff161a4aa8 T0)    ==29739==The signal is caused by a READ memory access.        #0 0x7f9b64dd2717  /build/glibc-SzIz7B/glibc-2.31/string/../sysdeps/x86_64/multiarch/strlen-avx2.S:96        #1 0x555c65e597d8 in __interceptor_strlen (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader_with_main+0x6407d8) (BuildId: 11ac8ec30f1d49fb0276c9b03368e491505d2bba)        #2 0x555c65fd85fa in ndpi_strdup /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:269:13        #3 0x555c65f3e8c6 in process_ndpi_collected_info /home/ivan/svnrepos/nDPI/example/reader_util.c:1188:36        #4 0x555c65f52cab in packet_processing /home/ivan/svnrepos/nDPI/example/reader_util.c:1567:2        #5 0x555c65f4b632 in ndpi_workflow_process_packet /home/ivan/svnrepos/nDPI/example/reader_util.c:2110:10        #6 0x555c65f04d29 in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:109:7        #7 0x555c65f054bb in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:181:17        #8 0x7f9b64c6e082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16        #9 0x555c65e4253d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader_with_main+0x62953d) (BuildId: 11ac8ec30f1d49fb0276c9b03368e491505d2bba)        ```        Found by oss-fuzzer.    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=48020
9040bc74	354addd6	Tue May 31 10:33:42 2022 +0200	TLS: fix stack-buffer-overflow error (#1567)	commit 9040bc74c94dbd44cd86b29ec3de40621df53467Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Tue May 31 10:33:42 2022 +0200    TLS: fix stack-buffer-overflow error (#1567)        ```    ==300852==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7f108951f060 at pc 0x5641db0ee78c bp 0x7fff3b10b910 sp 0x7fff3b10b0d0    WRITE of size 116 at 0x7f108951f060 thread T0        #0 0x5641db0ee78b in __interceptor_strncpy (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x64e78b) (BuildId: 23cb34bbaf8ac11eb97563bbdc12e29ead9fb0fa)        #1 0x5641db28efad in tlsCheckUncommonALPN /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:1224:7        #2 0x5641db27ec76 in processClientServerHello /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:1533:6        #3 0x5641db295677 in processTLSBlock /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:865:5        #4 0x5641db2935bb in ndpi_search_tls_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:1024:2        #5 0x5641db28f692 in ndpi_search_tls_wrapper /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:2446:5        #6 0x5641db1d87ce in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5150:6        #7 0x5641db1d91e4 in check_ndpi_tcp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5198:12        #8 0x5641db1d8e87 in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5217:12        #9 0x5641db1eb4a7 in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6076:15        #10 0x5641db140b45 in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:29:5        #11 0x5641db14130b in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:101:17        #12 0x7f108bcab082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16        #13 0x5641db07f46d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x5df46d) (BuildId: 23cb34bbaf8ac11eb97563bbdc12e29ead9fb0fa)        Address 0x7f108951f060 is located in stack of thread T0 at offset 96 in frame        #0 0x5641db28ec4f in tlsCheckUncommonALPN /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:1204          This frame has 1 object(s):        [32, 96) 'str' (line 1218) <== Memory access at offset 96 overflows this variable    HINT: this may be a false positive if your program uses some custom stack unwind mechanism, swapcontext or vfork          (longjmp and C++ exceptions *are* supported)    SUMMARY: AddressSanitizer: stack-buffer-overflow (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x64e78b) (BuildId: 23cb34bbaf8ac11eb97563bbdc12e29ead9fb0fa) in __interceptor_strncpy    Shadow bytes around the buggy address:    ```        Avoid zeroing the entire string.        Found by oss-fuzzer    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=47730
ca115774	912b69af	Mon May 30 19:40:47 2022 +0200	TLS: fix use-of-uninitialized-value error (#1566)	commit ca115774c9d735dc48a241682efded272011c009Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Mon May 30 19:40:47 2022 +0200    TLS: fix use-of-uninitialized-value error (#1566)        ```    Uninitialized bytes in __interceptor_strlen at offset 0 inside [0x7ffc987443a0, 7)    ==282918==WARNING: MemorySanitizer: use-of-uninitialized-value        #0 0x5651277e001b in ndpi_strdup /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:268:13        #1 0x5651277a45c1 in ndpi_set_risk /home/ivan/svnrepos/nDPI/src/lib/ndpi_utils.c:2254:12        #2 0x5651278cfaa6 in processClientServerHello /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:1515:8        #3 0x5651278e7834 in processTLSBlock /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:865:5        #4 0x5651278e60bd in ndpi_search_tls_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:1024:2        #5 0x5651278e1ffc in ndpi_search_tls_wrapper /home/ivan/svnrepos/nDPI/src/lib/protocols/tls.c:2445:5        #6 0x565127831c2a in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5150:6        #7 0x565127832938 in check_ndpi_tcp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5198:12        #8 0x5651278323a1 in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5217:12        #9 0x565127843e3a in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6076:15        #10 0x56512778641f in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:29:5        #11 0x5651277874ae in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:101:17        #12 0x7f4c46794082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16        #13 0x5651276fe40d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0xa340d)    ```    Found by oss-fuzzer    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=47728
c4f50b2c	3b825fca	Mon May 30 14:39:01 2022 +0200	HTTP: fix heap-buffer-overflow error (#1564)	commit c4f50b2cdac989cc89930564a88a5caab85c7214Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Mon May 30 14:39:01 2022 +0200    HTTP: fix heap-buffer-overflow error (#1564)        ```    ==222479==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60b000014739 at pc 0x55af06f2364f bp 0x7ffd7b6f4bf0 sp 0x7ffd7b6f4378    READ of size 12 at 0x60b000014739 thread T0        #0 0x55af06f2364e in printf_common(void*, char const*, __va_list_tag*) asan_interceptors.cpp.o        #1 0x55af06f24f70 in __interceptor_snprintf (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader_with_main+0x613f70) (BuildId: f6545ec2bd7663bc3f16aeeb87bddc64d173a2a8)        #2 0x55af0720927f in ndpi_check_http_header /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:982:2        #3 0x55af071f4797 in ndpi_check_http_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1219:5        #4 0x55af071f05c5 in ndpi_search_http_tcp /home/ivan/svnrepos/nDPI/src/lib/protocols/http.c:1402:3        #5 0x55af07080d1e in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5150:6        #6 0x55af07081734 in check_ndpi_tcp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5198:12        #7 0x55af070813d7 in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5217:12        #8 0x55af070939f7 in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:6076:15        #9 0x55af06fc7e1f in packet_processing /home/ivan/svnrepos/nDPI/example/reader_util.c:1541        #10 0x55af06fc7e1f in ndpi_workflow_process_packet /home/ivan/svnrepos/nDPI/example/reader_util.c:2110        #11 0x55af06fc2859 in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:109:7        #12 0x55af06fc2feb in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:181:17        #13 0x7efe5eaac082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16        #14 0x55af06f0055d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader_with_main+0x5ef55d) (BuildId: f6545ec2bd7663bc3f16aeeb87bddc64d173a2a8)        0x60b000014739 is located 0 bytes to the right of 105-byte region [0x60b0000146d0,0x60b000014739)    allocated by thread T0 here:        #0 0x55af06f84bae in malloc (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader_with_main+0x673bae) (BuildId: f6545ec2bd7663bc3f16aeeb87bddc64d173a2a8)        #1 0x55af06fc2673 in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:103:31        #2 0x55af06fc2feb in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:181:17        #3 0x7efe5eaac082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16        ```    Fiund by oss-fuzzer.    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=47724
d5005f58	bc2ad340	Mon Apr 25 19:01:11 2022 +0200	Raknet: fix heap-buffer-overflow (#1531)	commit d5005f584c4baf67e084e3bc8b052ca27004550eAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Mon Apr 25 19:01:11 2022 +0200    Raknet: fix heap-buffer-overflow (#1531)        ```    ==120637==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x606000000488 at pc 0x55a0598d97ec bp 0x7ffcfe13f2e0 sp 0x7ffcfe13f2d8    READ of size 2 at 0x606000000488 thread T0        #0 0x55a0598d97eb in ndpi_search_raknet /home/ivan/svnrepos/nDPI/src/lib/protocols/raknet.c:152:38        #1 0x55a05966c48e in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5060:6        #2 0x55a05966e428 in check_ndpi_udp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5119:10        #3 0x55a05966dddc in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5152:12        #4 0x55a05967fa7a in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5971:15        #5 0x55a05962b860 in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:24:3        #6 0x55a05962bd9b in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:84:17        #7 0x7f4aad7d80b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16        #8 0x55a05956b46d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x5d746d) (BuildId: 9429d3d08edc3836e5536f93c07f140716d8b82e)        0x606000000488 is located 9 bytes to the right of 63-byte region [0x606000000440,0x60600000047f)    allocated by thread T0 here:        #0 0x55a0595ee80e in malloc (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x65a80e) (BuildId: 9429d3d08edc3836e5536f93c07f140716d8b82e)        #1 0x55a05962bd06 in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:70:17        #2 0x7f4aad7d80b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16    ```        Found by oss-fuzz    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=47000
739dfc54	8b2c9860	Mon Apr 18 20:54:13 2022 +0200	Kerberos: fix Undefined-shift error (#1516)	commit 739dfc54b06a6995bc4d286eb400e2675b480febAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Mon Apr 18 20:54:13 2022 +0200    Kerberos: fix Undefined-shift error (#1516)        Similar to the error fixed in 4775be3d    Found by oss-fuzz.    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=46713
4775be3d	e00997ea	Wed Apr 13 18:10:56 2022 +0200	Kerberos: fix some memory access errors (#1514)	commit 4775be3d85434d4e385f43a47b783844bbfb2571Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Wed Apr 13 18:10:56 2022 +0200    Kerberos: fix some memory access errors (#1514)        ```    ==19724==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60e00000045e at pc 0x5620b8b3d3cc bp 0x7ffe0fda6b50 sp 0x7ffe0fda6310    READ of size 2 at 0x60e00000045e thread T0        #0 0x5620b8b3d3cb in __interceptor_strncpy (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x63f3cb) (BuildId: ee53ff920c8cd4c226d8520a0d4846d8864726b6)        #1 0x5620b8d9b69c in strncpy_lower /home/ivan/svnrepos/nDPI/src/lib/protocols/kerberos.c:208:4        #2 0x5620b8d995a0 in krb_parse /home/ivan/svnrepos/nDPI/src/lib/protocols/kerberos.c:316:5        #3 0x5620b8d97a90 in ndpi_search_kerberos /home/ivan/svnrepos/nDPI/src/lib/protocols/kerberos.c:687:12        #4 0x5620b8bcef35 in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:4996:4        #5 0x5620b8bd1be8 in check_ndpi_udp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5072:10        #6 0x5620b8bd159c in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5105:12        #7 0x5620b8be323a in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5924:15        #8 0x5620b8b8f7e0 in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:24:3        #9 0x5620b8b8fd1b in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:84:17        #10 0x7f45b32b90b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16        #11 0x5620b8acf47d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x5d147d) (BuildId: ee53ff920c8cd4c226d8520a0d4846d8864726b6)        0x60e00000045e is located 0 bytes to the right of 158-byte region [0x60e0000003c0,0x60e00000045e)    allocated by thread T0 here:        #0 0x5620b8b5283e in malloc (/home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet_with_main+0x65483e) (BuildId: ee53ff920c8cd4c226d8520a0d4846d8864726b6)        #1 0x5620b8b8fc86 in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_process_packet.c:70:17        #2 0x7f45b32b90b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16    ```        ```    protocols/kerberos.c:79:52: runtime error: left shift of 255 by 24 places cannot be represented in type 'int'    ```        Found by oss-fuzz:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=46670    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=46636
06a0abb6	e3faecf9	Sun Apr 10 16:59:34 2022 +0200	TINC: fix invalid memory read (#1512)	commit 06a0abb6fdf8fb7a446ef5aafdf2c7d24608977fAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Sun Apr 10 16:59:34 2022 +0200    TINC: fix invalid memory read (#1512)        ```    =================================================================    ==19324==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60600061be96 at pc 0x55b4a4cb4460 bp 0x7ffc7b461a70 sp 0x7ffc7b461a68    READ of size 1 at 0x60600061be96 thread T0        #0 0x55b4a4cb445f in ndpi_check_tinc /home/ivan/svnrepos/nDPI/src/lib/protocols/tinc.c:105:9        #1 0x55b4a4cb1888 in ndpi_search_tinc /home/ivan/svnrepos/nDPI/src/lib/protocols/tinc.c:135:5        #2 0x55b4a4b4a6e1 in check_ndpi_detection_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5013:6        #3 0x55b4a4b4c2d4 in check_ndpi_tcp_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5084:12        #4 0x55b4a4b4bf77 in ndpi_check_flow_func /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5103:12        #5 0x55b4a4b5dcca in ndpi_detection_process_packet /home/ivan/svnrepos/nDPI/src/lib/ndpi_main.c:5924:15        #6 0x55b4a4a87734 in packet_processing /home/ivan/svnrepos/nDPI/example/reader_util.c:1519:31        #7 0x55b4a4a80761 in ndpi_workflow_process_packet /home/ivan/svnrepos/nDPI/example/reader_util.c:2093:10        #8 0x55b4a4a39c8d in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:107:7        #9 0x55b4a4a3a46b in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:179:17        #10 0x7f69c63760b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16        #11 0x55b4a497954d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader_with_main+0x61654d) (BuildId: 705ebc5c412d267294a65cb01f03a1f012aeaf20)        0x60600061be96 is located 0 bytes to the right of 54-byte region [0x60600061be60,0x60600061be96)    allocated by thread T0 here:    [...]    ```    Found by oss-fuzz:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=46499
61a3c2eb	8b062295	Sun Feb 27 14:18:23 2022 +0100	reader_util: fix TZSP decapsulation (#1460)	commit 61a3c2eb5b3cac0f36a1bfadc5261b7694d3bfabAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Sun Feb 27 14:18:23 2022 +0100    reader_util: fix TZSP decapsulation (#1460)        ```    ==38674==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60400008957f at pc 0x5653fcee6434 bp 0x7ffe9b554b50 sp 0x7ffe9b554b48    READ of size 1 at 0x60400008957f thread T0        #0 0x5653fcee6433 in ndpi_workflow_process_packet /home/ivan/svnrepos/nDPI/example/reader_util.c:2050:18        #1 0x5653fce9fc0d in LLVMFuzzerTestOneInput /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:107:7        #2 0x5653fcea03eb in main /home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader.c:179:17        #3 0x7fe71dc3d0b2 in __libc_start_main /build/glibc-YbNSs7/glibc-2.31/csu/../csu/libc-start.c:308:16        #4 0x5653fcddf67d in _start (/home/ivan/svnrepos/nDPI/fuzz/fuzz_ndpi_reader_with_main+0x58a67d) (BuildId: 525418a27e8c37d6c492cc3220e0e97809c40f98)        0x60400008957f is located 0 bytes to the right of 47-byte region [0x604000089550,0x60400008957f)    allocated by thread T0 here:    ```        Found by oss-fuzz    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45036
96f8942f	27977906	Tue Feb 22 19:58:17 2022 +0100	reader_util: fix parsing of IPv6 extension headers (#1453)	commit 96f8942f75f6f489312779a0c5ec22b7520319caAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Tue Feb 22 19:58:17 2022 +0100    reader_util: fix parsing of IPv6 extension headers (#1453)        Found by oss-fuzz    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=44942
27977906	fbb97000	Tue Feb 22 19:56:41 2022 +0100	reader_util: fix infinite loop in packet dissection (#1454)	commit 279779062c5df0ef5780ed3dfadf87b606adaa71Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Tue Feb 22 19:56:41 2022 +0100    reader_util: fix infinite loop in packet dissection (#1454)        Found by oss-fuzz    See: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=44944
f229068f	a6ff0dd0	Wed Feb 9 11:46:39 2022 +0100	Fix memory access in ndpi_strnstr() (#1438)	commit f229068fd3844cd2fd458e5ae76c20ec059c8d3eAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Wed Feb 9 11:46:39 2022 +0100    Fix memory access in ndpi_strnstr() (#1438)        Found by oss-fuzz:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=44482        It should be the same error reported (and only partially fixed) in    79968f32
ff38d4b9	79968f32	Mon Feb 7 18:05:12 2022 +0100	TLS: fix parsing of certificate elements (#1435)	commit ff38d4b98008d3b10dbdee0330e9b8c62a99ce9aAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Mon Feb 7 18:05:12 2022 +0100    TLS: fix parsing of certificate elements (#1435)        Found by oss-fuzz:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=44280    ```    ==263603==WARNING: MemorySanitizer: use-of-uninitialized-value        #0 0x592478 in ndpi_is_printable_string ndpi/src/lib/ndpi_utils.c:2200:9        #1 0x5b047c in processCertificateElements ndpi/src/lib/protocols/tls.c:400:7        #2 0x5ac880 in processCertificate ndpi/src/lib/protocols/tls.c:790:7        #3 0x5c3a32 in processTLSBlock ndpi/src/lib/protocols/tls.c:844:13        #4 0x5c2c61 in ndpi_search_tls_tcp ndpi/src/lib/protocols/tls.c:973:2        #5 0x5c117d in ndpi_search_tls_wrapper ndpi/src/lib/protocols/tls.c:2367:5        #6 0x552a50 in check_ndpi_detection_func ndpi/src/lib/ndpi_main.c:4792:6    ```
9dcc4a23	011ee3ec	Thu Jan 27 10:59:35 2022 +0100	Kerberos, TLS, example: fix some memory errors (#1419)	commit 9dcc4a2334fa10d7d0a3c019ee35dfde4c06e044Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Thu Jan 27 10:59:35 2022 +0100    Kerberos, TLS, example: fix some memory errors (#1419)        Detected by oss-fuzz:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43823    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43921    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43925
9f050fa0	bd036f96	Tue Jan 18 21:52:37 2022 +0100	TLS, H323, examples: fix some memory errors (#1414)	commit 9f050fa0a65f3403c1f8296faf5f9d88d4900a8dAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Tue Jan 18 21:52:37 2022 +0100    TLS, H323, examples: fix some memory errors (#1414)        Detected by oss-fuzz:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=26880    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=26906    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43782    https://oss-fuzz.com/testcase-detail/6334089358082048
bd036f96	c2b7d777	Tue Jan 18 19:11:01 2022 +0100	Netbios, CSGO: fix two memory errors (#1413)	commit bd036f96f9bf3feb7ef4699b4f9882705b853ed1Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Tue Jan 18 19:11:01 2022 +0100    Netbios, CSGO: fix two memory errors (#1413)        Detected by oss-fuzz:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43754    https://oss-fuzz.com/testcase-detail/5329842395021312
e4a7990a	d19bd965	Mon Jan 17 19:47:27 2022 +0100	H323: fix a use-after-poison error (#1412)	commit e4a7990a4e4842b4e6f5b10fb51ab288fa340240Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Mon Jan 17 19:47:27 2022 +0100    H323: fix a use-after-poison error (#1412)        Detected by oss-fuzz    See: https://oss-fuzz.com/testcase-detail/6730505580576768        Fix a function prototype    Update a unit test results
1ff308af	05734f3d	Sun Jan 16 20:31:48 2022 +0100	TLS: fix a use-of-uninitialized-value error (#1411)	commit 1ff308af0920deb5f14809947887967bdc3848cbAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Sun Jan 16 20:31:48 2022 +0100    TLS: fix a use-of-uninitialized-value error (#1411)        Detected by oss-fuzz:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43705
05734f3d	611c753d	Sun Jan 16 19:28:39 2022 +0100	Zattoo: fix Null-dereference READ with ipv6 traffic (#1410)	commit 05734f3d314a31facbce61799b98206ccc5963a5Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Sun Jan 16 19:28:39 2022 +0100    Zattoo: fix Null-dereference READ with ipv6 traffic (#1410)        Fix: 20b5f6d7    Detected by oss-fux:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43700
e46b508a	eb5d7b07	Sat Jan 15 20:53:36 2022 +0100	Kerberos: fix use-of-uninitialized-value error (#1409)	commit e46b508a36415b0fc76dbaaf6e65a5d9e425598fAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Sat Jan 15 20:53:36 2022 +0100    Kerberos: fix use-of-uninitialized-value error (#1409)        Detected by oss-fuzz:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43677
eb5d7b07	63c44a24	Sat Jan 15 18:47:59 2022 +0100	TLS: fix heap-buffer-overflow error (#1408)	commit eb5d7b07afae0d1dd8f5b079835d8f1ec66dc160Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Sat Jan 15 18:47:59 2022 +0100    TLS: fix heap-buffer-overflow error (#1408)        Detected by oss-fuzz:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43664
b080a1c1	552d199d	Wed Jan 12 20:24:57 2022 +0100	Fix two use-of-uninitialized-value errors (#1398)	commit b080a1c136fadb675c42bb72309e7c479ac7d292Author: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Wed Jan 12 20:24:57 2022 +0100    Fix two use-of-uninitialized-value errors (#1398)        Found by oss-fuzz:    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40269    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=41432        Fix fuzz compilation (follow-up of f5545a80)
06f3b079	3a087e95	Tue Jan 11 17:57:34 2022 +0100	QUIC: fix an integer overflow (#1396)	commit 06f3b079093a202a9565bbd27b6b278dc15f420dAuthor: Ivan Nardi <12729895+IvanNardi@users.noreply.github.com>Date:   Tue Jan 11 17:57:34 2022 +0100    QUIC: fix an integer overflow (#1396)        Reported by oss-fuzz:    ```    ==685288==ERROR: AddressSanitizer: SEGV on unknown address 0x61a100000687 (pc 0x0000005aba64 bp 0x7ffe3f29f510 sp 0x7ffe3f29f400 T0)    ==685288==The signal is caused by a READ memory access.    SCARINESS: 20 (wild-addr-read)     #0 0x5aba64 in quic_len ndpi/src/lib/protocols/quic.c:203:12     #1 0x5aba64 in decrypt_initial_packet ndpi/src/lib/protocols/quic.c:993:16     #2 0x5aba64 in get_clear_payload ndpi/src/lib/protocols/quic.c:1302:21     #3 0x5aba64 in ndpi_search_quic ndpi/src/lib/protocols/quic.c:1658:19     #4 0x579f00 in check_ndpi_detection_func ndpi/src/lib/ndpi_main.c:4683:6     #5 0x57abe6 in ndpi_check_flow_func ndpi/src/lib/ndpi_main.c:0     #6 0x583b2c in ndpi_detection_process_packet ndpi/src/lib/ndpi_main.c:5545:15     #7 0x55e75e in LLVMFuzzerTestOneInput ndpi/fuzz/fuzz_process_packet.c:30:3    [...]    ```
