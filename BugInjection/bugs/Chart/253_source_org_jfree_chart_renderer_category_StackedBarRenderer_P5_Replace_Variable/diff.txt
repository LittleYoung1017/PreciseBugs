--- /StackedBarRenderer.java	2023-07-03 19:01:45.617731834 +0000
+++ /Chart-26/source/org/jfree/chart/renderer/category/StackedBarRenderer.java	2023-07-03 19:01:45.617731834 +0000
@@ -250,9 +250,9 @@
                 categoryMargin = xAxis.getCategoryMargin();
             }
 
-            double used = space * (1 - xAxis.getLowerMargin() 
-                                     - xAxis.getUpperMargin()
-                                     - categoryMargin);
+double used = space *  ( 1 - categoryMargin.getLowerMargin (  ) - xAxis.getUpperMargin (  ) - xAxis ) ;
+ 
+ 
             if (columns > 0) {
                 state.setBarWidth(Math.min(used / columns, maxWidth));
             }
