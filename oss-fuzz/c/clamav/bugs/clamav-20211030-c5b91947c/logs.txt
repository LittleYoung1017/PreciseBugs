commit c5b91947c6cf98c6048eb98994ef2db6496158e5Author: Micah Snyder <micasnyd@cisco.com>Date:   Wed Oct 20 21:10:59 2021 -0700    Fix leak in email parser when using gen-json option        The mbox.c:messageGetFilename() function returns a COPY of the filename,    which must be free()'d.    Fixes: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=31775        Also fixed and issue where the email parser may fail to finish parsing    soem multipart emails when --gen-json is enabled if messageGetJObj() or    cli_json_addowner() fail. These should be non-fatal failures. The rest    of the (broken) email should be parsed.        The email parser (mbox.c & message.c) also has a lot of assertions    instead using if()'s for error handling.        Because of the complexity of the email parser, it's unclear for many of    the assertions if they could be triggered based on user input like    scanning a malformed email. So to be safe, I've replaced all of the    assertions in this parser with error handling to fail gracefully.        Also fix formatting issues and use `stdbool.h`'s `true` instead of `TRUE`.
