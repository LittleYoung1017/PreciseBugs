samba-20230707-47b6696dcdf	47b6696dcdf	6f073f258f1	Fri Jul 7 00:17:31 2023 +0000	librpc:ndr: Fix overflow in ndr_push_expand	commit 47b6696dcdfe7c5cb6e58ac6586ba45d39c39cc6Author: Joseph Sutton <josephsutton@catalyst.net.nz>Date:   Thu Jul 6 10:50:05 2023 +1200    librpc:ndr: Fix overflow in ndr_push_expand        If ‘size’ was equal to UINT32_MAX, the expression ‘size+1’ could    overflow to zero.        This could result in inadequate memory being allocated, which could    cause ndr_pull_compression_xpress_huff_raw_chunk() to overflow memory    with zero bytes.        Credit to OSS-Fuzz.        REF: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=57728        BUG: https://bugzilla.samba.org/show_bug.cgi?id=15415        Signed-off-by: Joseph Sutton <josephsutton@catalyst.net.nz>    Reviewed-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>	57728	librpc/ndr/ndr.c	286
samba-20230505-ff2de50aa4b	ff2de50aa4b	7dab9edca86	Fri May 5 02:54:30 2023 +0000	librpc: Fix talloc hierarchy for ndr_compression_state	commit ff2de50aa4bf086880ab8cd1c2aee7e998c2c22aAuthor: Andrew Bartlett <abartlet@samba.org>Date:   Mon May 1 14:13:15 2023 +1200    librpc: Fix talloc hierarchy for ndr_compression_state        The complexity of generic_mszip_free() is not needed, nor is a talloc    destructor required if the memory is correctly created in a tree.        Credit to OSS-Fuzz for showing the use-after-free        REF: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=57608        BUG: https://bugzilla.samba.org/show_bug.cgi?id=15349        Signed-off-by: Andrew Bartlett <abartlet@samba.org>    Reviewed-by: Joseph Sutton <josephsutton@catalyst.net.nz>	57608	librpc/ndr/ndr_cab.c;librpc/ndr/ndr_compression.c	369;977;1025;1045;1109;1129
samba-20220817-233a0cd6de9	233a0cd6de9	72f16b63544	Wed Aug 17 10:08:35 2022 +0000	lib:fuzzing: Fix shellcheck errors in build_samba.sh	commit 233a0cd6de9d0d0aac07f1f8d753780e53dbe2b0Author: Andreas Schneider <asn@samba.org>Date:   Tue Feb 22 18:01:31 2022 +0100    lib:fuzzing: Fix shellcheck errors in build_samba.sh        lib/fuzzing/oss-fuzz/build_samba.sh:24:27: error: Double quote array    expansions to avoid re-splitting elements. [SC2068]        Signed-off-by: Andreas Schneider <asn@samba.org>    Reviewed-by: Pavel Filipenský <pfilipensky@samba.org>	2427	lib/fuzzing/oss-fuzz/build_samba.sh	21
samba-20210708-8cce23acb9f	8cce23acb9f	cf1baa8be90	Thu Jul 8 09:30:40 2021 +0000	witness.idl: fix length calculation for witness_IPaddrInfoList	commit 8cce23acb9f9bdde8bff3c3a7ffa83361e3a64a6Author: Stefan Metzmacher <metze@samba.org>Date:   Fri Jul 31 11:27:25 2020 +0200    witness.idl: fix length calculation for witness_IPaddrInfoList        If r->num is 0, we should not dereference r->addr.        Using ndr_size_witness_IPaddrInfoList() also make this much simpler    and avoids the magic 12.        Credit Oss-Fuzz        REF: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=22175    REF: https://oss-fuzz.com/testcase-detail/5686294157197312        BUG: https://bugzilla.samba.org/show_bug.cgi?id=14452        Signed-off-by: Stefan Metzmacher <metze@samba.org>    Reviewed-by: Samuel Cabrero <scabrero@samba.org>	22175	librpc/idl/witness.idl;source4/torture/ndr/witness.c	98;400
samba-20200807-bf16cd72b28	bf16cd72b28	889c461c009	Fri Aug 7 03:23:44 2020 +0000	ndr: fix ndr_pull_string_array() off by one alloc	commit bf16cd72b285662bcb4367cd2bdd6eac7655254fAuthor: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>Date:   Wed Aug 5 11:04:11 2020 +1200    ndr: fix ndr_pull_string_array() off by one alloc        The correct line should have been               talloc_realloc(ndr->current_mem_ctx, a, const char *, count + 2);        because if the loop does not increment count on exit (it exits via    break), so count is left pointing at the thing that just got put in.    i.e., if there was one item it is at a[0], count is 0, but we also    need the trailing NULL byte at a[1] and the length is 2. Thus + 2, not    + 1.        This will not affect ordinary (that is, non-malicious) traffic,    because talloc_realloc will not actually realloc unless it is saving a    kilobyte. Since the allocation grows slowly with the exponent ~1.25,    the actual reallocs will start happening at some point between 512 and    1024 items.        In the example we have, there were 666 pointers, and space for 824 was    allocated.        Rather than doing the +2 realloc, it is simpler to leave it off    altogether; in the common case (<512 items) it is a no-op anyway, and    in the best possible case it reduces the temporary array by 20%.        Credit to OSS-Fuzz.        REF: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=24646        Signed-off-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>    Reviewed-by: Andrew Bartlett <abartlet@samba.org>	24646	librpc/ndr/ndr_string.c	437
samba-20200207-490bbb96b9b	490bbb96b9b	14182350f83	Fri Feb 7 08:53:40 2020 +0000	libprc ndr tests: Fix ndrdump test ntlmssp_CHALLENGE_MESSAGE	commit 490bbb96b9bd082a190a590a6137f0e24f80a6e4Author: Gary Lockyer <gary@catalyst.net.nz>Date:   Fri Feb 7 10:50:07 2020 +1300    libprc ndr tests: Fix ndrdump test ntlmssp_CHALLENGE_MESSAGE        Fix the expected data in fuzzed_ntlmssp-CHALLENGE_MESSAGE.txt, as it    contained source code line numbers.        Andrew this test needs to be altered to us a regular expression and    remove the dependency on source line numbers.        Credit to OSS-Fuzz        REF: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=20083    BUG: https://bugzilla.samba.org/show_bug.cgi?id=14236        Signed-off-by: Gary Lockyer <gary@catalyst.net.nz>    Reviewed-by: Andrew Bartlett <abartlet@samba.org>	20083	selftest/knownfail.d/bug-14236;source4/librpc/tests/fuzzed_ntlmssp-CHALLENGE_MESSAGE.txt	1 +0;38
